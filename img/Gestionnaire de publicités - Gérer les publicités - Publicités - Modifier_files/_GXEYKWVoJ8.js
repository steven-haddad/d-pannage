if (self.CavalryLogger) { CavalryLogger.start_js(["nezBZ"]); }

__d("PinnedConversationNubsActionTaken",[],(function(a,b,c,d,e,f){e.exports={TAB_CLOSED_BY_USER:0}}),null);
__d("BuddyListNub",["csx","cx","fbt","Arbiter","AsyncRequest","AvailableList","BootloadedComponent.react","ChannelConnection","ChatConfig","ChatOptions","ChatSidebarActions","ChatSidebarStore","ChatSidebarVisibility","ChatVisibility","CSS","Dock","DOM","Event","JSLogger","JSResource","KeyboardShortcuts","Keys","NubController","OrderedFriendsList","Parent","PresencePrivacy","PresenceStatus","PresenceUtil","React","ReactDOM","Run","SidebarType","Style","Toggler","emptyFunction","gkx","intlNumUtils","translateKey"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j=b("gkx")("697231"),k=40,l=253,m=j?"277px":"285px",n=b("JSLogger").create("buddylist_nub");a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d,e,f){__p&&__p();var g;g=a.call(this)||this;a.prototype.init.call(babelHelpers.assertThisInitialized(g),c);g.root=c;g.orderedList=d;g.button=b("DOM").find(c,"a.fbNubButton");g.unreadCount=b("DOM").find(c,"span._5ayx");g.label=b("DOM").find(c,"span.label");g.buddyListTitle=b("DOM").find(c,".titlebarTextWrapper");g.body=b("DOM").scry(c,"div.fbNubFlyoutBody")[0];g.container=b("Parent").bySelector(c,"._56ox");var h=b("DOM").find(c,"div.fbNubFlyoutTitlebar");b("Toggler").createInstance(h).setSticky(!1);b("Toggler").createInstance(c).setSticky(!0);var j=b("DOM").scry(c,"._7oue");f&&b("Run").onAfterLoad(function(){g.dropdown=b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("ChatSidebarDropdown.react").__setRef("BuddyListNub"),onToggleSidebar:function(){},sidebarType:b("SidebarType").BUDDYLIST}),f)});d.subscribeOnce("render",g.flyoutContentChanged.bind(babelHelpers.assertThisInitialized(g)));b("Run").onAfterLoad(function(){__p&&__p();var a=b("DOM").find(h,"div._4k48");a&&b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("ChatSidebarComposeLink.react").__setRef("BuddyListNub"),className:"_3a-4"}),a);a=b("DOM").find(g.button,"div._1us9");a&&b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("ChatSidebarComposeLink.react").__setRef("BuddyListNub"),className:"_3a-4"}),a);a=b("DOM").find(g.button,"div._1usa");a&&b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("ChatSidebarDropdown.react").__setRef("BuddyListNub"),onToggleSidebar:function(){},sidebarType:b("SidebarType").BUDDYLIST_NUB}),a);a=b("DOM").find(h,"div._3gl7");a&&b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("ChatSidebarGroupCreateButtonReactComponent").__setRef("BuddyListNub")}),a);a=b("DOM").find(g.button,"div._3gll");a&&b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("ChatSidebarGroupCreateButtonReactComponent").__setRef("BuddyListNub"),className:"newGCF"}),a)});d.setScrollContainer(g.body);b("AvailableList").subscribe("buddylist/availability-changed",g._updateCount.bind(babelHelpers.assertThisInitialized(g)));b("Arbiter").subscribe("chat/connect",function(){return g._handleConnect(!0)});b("Arbiter").subscribe("chat/option-changed",function(a,b){b.name=="hide_groups"?this.onResize():b.name==="hide_buddylist"&&(b.value?this.hide():this.show())}.bind(babelHelpers.assertThisInitialized(g)));b("ChannelConnection").subscribe(b("ChannelConnection").CONNECTED,function(){return g._updateView()});b("ChannelConnection").subscribe(b("ChannelConnection").SHUTDOWN,function(){return g._updateView()});b("ChannelConnection").subscribe(b("ChannelConnection").RECONNECTING,function(){return g._updateView()});b("ChannelConnection").subscribe([b("ChannelConnection").MUTE_WARNING,b("ChannelConnection").UNMUTE_WARNING],function(){return g._updateView()});g.subscribe("show",g.onShow.bind(babelHelpers.assertThisInitialized(g)));g.subscribe("hide",g.onHide.bind(babelHelpers.assertThisInitialized(g)));g.subscribe("resize",g.onResize.bind(babelHelpers.assertThisInitialized(g)));b("Event").listen(c,"keydown",g._onKeyDown.bind(babelHelpers.assertThisInitialized(g)));b("Event").listen(g.button,"click",g.onButtonClick.bind(babelHelpers.assertThisInitialized(g)));b("KeyboardShortcuts").register("q",function(a){g._isOpen||(g.onButtonClick(),g.show()),a.prevent()},{persistOnTransition:!0,shortcutInfo:{displayKeys:[b("translateKey")("q")],description:i._("Rechercher dans les contacts Messenger")}});b("Arbiter").subscribe("minisidebar/show",g.hide.bind(babelHelpers.assertThisInitialized(g)));b("Arbiter").subscribe("sidebar/visibility",function(a,b){b?g.hide():g._onSidebarHide()});b("Style").set(g.body,"min-height",m);b("Arbiter").subscribe("sidebar/typeahead/active",function(a,c){c?(g._typeaheadActive=!0,b("CSS").hide(g.body.parentNode),g.orderedList.hide(),g.onResize()):(g._typeaheadActive=!1,g.onResize(),b("CSS").show(g.body.parentNode),g.orderedList.show())});b("OrderedFriendsList").getList(function(a){b("ChatSidebarStore").isEnabled()&&b("ChatSidebarStore").getVisibleType()===b("SidebarType").BUDDYLIST&&!b("ChatOptions").getSetting("hide_buddylist")&&!b("ChannelConnection").disconnected()&&!b("PresencePrivacy").isUserOffline()&&a.length>0&&g.show(),b("Event").listen(h,"click",function(a){b("CSS").matchesSelector(a.target,".titlebarTextWrapper")&&g._syncHideBuddylist(!0)}),j.forEach(function(a){var c=this;b("Event").listen(a,"click",function(a){c._syncHideBuddylist(!0)})},babelHelpers.assertThisInitialized(g)),g._updateView(),n.log("buddylist_initialized")});return g}var d=c.prototype;d._handleVisibilityChange=function(){this._updateView(),b("ChatVisibility").isOnline()||this.hide()};d._updateView=function(a){__p&&__p();var c;if(!b("ChatVisibility").isOnline())a=b("gkx")("807896")?i._("{Chat}",[i._param("Chat",i._("Discussion instantan\u00e9e"))]):i._("{Chat} (Off)",[i._param("Chat",i._("Discussion instantan\u00e9e"))]);else if(b("ChannelConnection").disconnected())a=i._("{Chat} (d\u00e9connect\u00e9e)",[i._param("Chat",i._("Discussion instantan\u00e9e"))]);else{var d=b("PresenceStatus").getOnlineCount();if(d){var e=b("DOM").create("span",{className:"count"},"("+b("intlNumUtils").formatNumberWithThousandDelimiters(d)+")");a=i._({"*":"{Chat} {number-available}"},[i._param("Chat",i._("Discussion instantan\u00e9e")),i._param("number-available",e,[0,d])])}else a=i._("Discussion instantan\u00e9e"),c=!0}this._setPresenceIcon();this._setUnread();this._setLabel(a,c);this._updateBuddyListTitle();this.buttonContentChanged()};d._updateBuddyListTitle=function(){__p&&__p();if(!j)return;var a,c=i._("Discussion instantan\u00e9e"),d="_6d4h";if(!b("ChatVisibility").isOnline()||b("ChannelConnection").disconnected())a=b("DOM").create("div",{"class":d},c);else{var e=b("PresenceStatus").getOnlineCount(),f;e&&(d="_6d4h _6d4i",f=b("DOM").create("div",{"class":"_6d4j"},i._("{subTitle} en ligne",[i._param("subTitle",b("intlNumUtils").formatNumberWithThousandDelimiters(e))])));e=b("DOM").create("div",{"class":d},c);f&&b("DOM").appendContent(e,f);a=e}d=this.buddyListTitle.textContent||this.buddyListTitle.innerText;if(a&&d!==a){c=this.buddyListTitle.cloneNode(!0);b("DOM").setContent(c,a);b("DOM").replace(this.buddyListTitle,c);this.buddyListTitle=c}};d._setPresenceIcon=function(){b("CSS").conditionClass(this.root,"offline",!b("ChatVisibility").isOnline()||b("ChannelConnection").disconnected())};d.onButtonClick=function(){if(!b("ChatSidebarStore").isInitialized())return!0;b("ChatSidebarVisibility").shouldShowSidebarIgnoreEnabled(null,function(a,c){c=b("ChatSidebarStore").isEnabled();!c&&a?b("ChatSidebarActions").enable(b("SidebarType").SIDEBAR):b("ChatSidebarActions").show(c&&a?b("SidebarType").SIDEBAR:b("SidebarType").BUDDYLIST)})};d.onHide=function(){this._isOpen=!1,this._buddyListRenderSubscription&&(this.orderedList.unsubscribe(this._buddyListRenderSubscription),this._buddyListRenderSubscription=null),this._hideBuddyList(),b("Arbiter").inform("buddylist/hide")};d._onKeyDown=function(a){a=b("Event").getKeyCode(a);if(a===b("Keys").ESC&&!b("CSS").hasClass(this.root,"menuOpened")){this.hide();return!1}else a==b("Keys").RETURN&&b("ChatSidebarVisibility").shouldShowSidebarIgnoreEnabled(null,function(a,c){b("ChatSidebarActions").enable(a?b("SidebarType").SIDEBAR:b("SidebarType").BUDDYLIST)})};d._onSidebarHide=function(a){var c=this;b("OrderedFriendsList").getList(function(a){b("ChatSidebarStore").isEnabled()&&!b("ChatOptions").getSetting("hide_buddylist")&&!b("ChannelConnection").disconnected()&&!b("PresencePrivacy").isUserOffline()&&a.lenth>0?c.show():c.hide()})};d.onResize=function(){var a=this._typeaheadActive?b("Dock").getMaxFlyoutHeight(this.root)-60:l;b("Arbiter").inform("buddyList/resized",a,"persistent");this._typeaheadActive?b("Style").set(this.body,"max-height","none"):b("Style").set(this.body,"max-height",m);a=Math.max(250,a);a=Math.floor(a/k);this.orderedList.setNumTopFriends(a,!1,b("SidebarType").BUDDYLIST)};d._showBuddyList=function(){var a=this;this._buddyListRenderSubscription=this.orderedList.subscribe("render",function(){b("Style").get(a.body,"height")!=m&&b("Style").set(a.body,"height",m)});this.orderedList.show();n.bump("buddylist_show")};d._hideBuddyList=function(){this.orderedList.hide(),n.bump("buddylist_hide")};d.onShow=function(){this._isOpen=!0,b("ChannelConnection").disconnected()?(b("ChannelConnection").reconnect(),this._showBuddyList()):b("ChatVisibility").goOnline(this._showBuddyList.bind(this)),this._syncHideBuddylist(!1)};d._setLabel=function(a,c){var d=this.label.textContent||this.label.innerText;if(d!==a){d=this.label.cloneNode(!0);b("DOM").setContent(d,a);b("DOM").replace(this.label,d);this.label=d}this.throbber&&b("CSS").conditionShow(this.throbber,!!c)};d._setUnread=function(a){b("CSS").conditionShow(this.unreadCount,!!a)};d._updateCount=function(){this._updateView()};d._syncHideBuddylist=function(a){b("ChatOptions").setSetting("hide_buddylist",a,"buddylist"),new(b("AsyncRequest"))("/ajax/chat/settings.php").setHandler(b("emptyFunction")).setErrorHandler(b("emptyFunction")).setData({hide_buddylist:a,window_id:b("PresenceUtil").getSessionID()}).setAllowCrossPageTransition(!0).send()};return c}(b("NubController"));b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,c){c.buddylist_visible=b("ChatSidebarStore").getVisibleType()===b("SidebarType").BUDDYLIST});e.exports=a}),null);
__d("UFIAddCommentActionType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CANCEL:"add_comment_cancel",CHANGE_CONTENT:"add_comment_change_content",RETRY_SUBMIT:"add_comment_retry_submit",SUBMIT_EDIT:"add_comment_submit_edit",SUBMIT_NEW:"add_comment_submit_new",PIVOT_SEND_MESSAGE:"pivot_send_message"})}),null);
__d("UFIKeyValueStore",["FluxReduceStore","abstractMethod"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.getValueFor=function(a){return this.getState()[a]||null};d.getStateKey=function(a){return a.instanceID};d.getStateValue=function(a){return b("abstractMethod")("UFIKeyValueStore","getStateValue")};d.reduce=function(a,b){var c=this.getStateKey(b);b=this.getStateValue(b);if(b!==null){var d;return babelHelpers["extends"]({},a,(d={},d[c]=b,d))}return a};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=a}),null);
__d("UFIComposerIsTypingStore",["UFIAddCommentActionType","UFIDispatcherBase","UFIKeyValueStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getStateKey=function(a){return a.ftentidentifier};d.getStateValue=function(a){switch(a.type){case b("UFIAddCommentActionType").SUBMIT_EDIT:return!1;case b("UFIAddCommentActionType").SUBMIT_NEW:return!1;case b("UFIAddCommentActionType").CHANGE_CONTENT:a=a.text.trim().length;return a>0}return null};return c}(b("UFIKeyValueStore"));e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("ConversationNubAddTabSource",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({NOTIFICATION:"notification",PAGE_REFRESH:"page_refresh",USER_PIN:"user_pin",UNSEEN_NOTIFICATION:"unseen_notification",UNKNOWN:"unknown"})}),null);
__d("ConversationNubTabStateListStorage",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){function a(){this.$1=[]}var b=a.prototype;b.modify=function(a){this.$1=a(this.$1)};b.getData=function(){return this.$1};return a}();e.exports=a}),null);
__d("differenceSets",["filterSet"],(function(a,b,c,d,e,f){"use strict";function a(a){for(var c=arguments.length,d=new Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return b("filterSet")(a,function(a){return!d.some(function(b){return b.has(a)})})}e.exports=a}),null);
__d("ConversationNubTabStateList",["invariant","ConversationNubTabStateListStorage","differenceSets"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$2=new Set(),this.$1=new(b("ConversationNubTabStateListStorage"))()}var c=a.prototype;c.modifyTabState=function(a,b){this.modifyTabs(function(c){var d=c.findIndex(function(b){return b.tabID===a});d!==-1||g(0,5816);b(c[d]);return c})};c.$3=function(a){return new Set(a.map(function(a){return a.tabID}))};c.modifyTabs=function(a){var c=this;try{this.$1.modify(function(d){var e=c.$3(d);d=a(d);var f=c.$3(d);c.$2=b("differenceSets")(e,f);return d})}finally{this.$2=new Set()}};c.getTabs=function(){return this.$1.getData()};c.getTabState=function(a){a=this.getTabStateIfExists(a);a||g(0,5816);return a};c.getTabStateIfExists=function(a){return this.getTabs().find(function(b){return b.tabID===a})};c.push=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];this.modifyTabs(function(a){b.forEach(function(b){a.find(function(a){return a.tabID===b.tabID})?g(0,5817,b.tabID):a.push(b)});return a})};c.remove=function(a){this.modifyTabs(function(b){var c=b.findIndex(function(b){return b.tabID===a});c!==-1&&b.splice(c,1);return b})};return a}();e.exports=a}),null);
__d("ConversationNubTabState",["invariant","ConversationNubTabStateList"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=12;a=function(){__p&&__p();function a(){this.$1=Object.create(null),this.$2=new(b("ConversationNubTabStateList"))(),this.$3=Infinity}var c=a.prototype;c.anyTabHasFocus=function(){return this.getUnsortedLoadedTabs().some(function(a){return a.getIsFocused()})};c.anyTabHasText=function(){return this.getUnsortedLoadedTabs().some(function(a){return a.getHasText()})};c.getTabState=function(a){return this.$2.getTabState(a)};c.getTabStateIfExists=function(a){return this.$2.getTabStateIfExists(a)};c.getUnloadedTabs=function(){var a=this,b=this.$2.getTabs().filter(function(b){return!a.getLoadedTab(b.tabID)});return b};c.setMaxDockTabs=function(a){this.$3=a};c.getNumDockTabs=function(){var a=this.$3,b=this.getTotalTabCount();return Math.min(a,b)};c.getNumMenuTabs=function(){return this.getTotalTabCount()-this.getNumDockTabs()};c.addTabState=function(a){this.$2.push(a)};c.addLoadedTab=function(a,b){var c=this.getTabState(a);if(!c)return;c=this.getLoadedTab(a);if(c)return;this.$1[a]=b;this.$4()};c.getLoadedTab=function(a){return this.$1[a]};c.getLoadedTabByFeedbackTarget=function(a){return this.getLoadedTabs().find(function(b){return b.getPersistentState().ftID===a})};c.isTabInDock=function(a){a=this.getLoadedTab(a);if(!a)return!1;a=this.$5(a);return 0<=a&&a<this.getNumDockTabs()};c.clearTabNotifications=function(a){this.$2.modifyTabState(a,function(a){a.unseenCommentsSinceLastCleared={},a.hasFakeInitBadge=!1,a.badgeCount=0,a.isBlinkingUnread=!1})};c.deleteTab=function(a){var b=this.getLoadedTab(a);b&&(delete this.$1[a],b.destroy());this.$2.remove(a);return Boolean(b)};c.deleteAllTabs=function(){var a=this;this.getUnsortedLoadedTabs().forEach(function(b){return a.deleteTab(b.getTabID())})};c.modifyTabState=function(a,b){return this.$2.modifyTabState(a,b)};c.moveTabToDockLeft=function(a){__p&&__p();var b=this,c=this.getLoadedTab(a);if(!c)return;this.$2.modifyTabs(function(d){__p&&__p();var e=d.findIndex(function(b){return b.tabID===a});e!==-1||g(0,5816);var f=d[e],h=b.$5(c),i=b.getLoadedTabs().length,j=b.getNumDockTabs();if(h<0||i===0)return d;else if(j===0){h!==0&&(d.splice(e,1),d.unshift(f));return d}i=j-1;if(h===i)return d;d.splice(e,1);h<i&&(i-=1);j=b.getLoadedTabs()[i];var k=b.getTabState(j.getTabID());k||g(0,6150);e=d.findIndex(function(a){return a.tabID===k.tabID});d.splice(e,0,f);return d})};c.getLoadedTabs=function(){var a=this,b=this.$2.getTabs().map(function(b){return a.getLoadedTab(b.tabID)}).filter(Boolean);return b};c.getUnsortedLoadedTabs=function(){var a=Object.values(this.$1);return a};c.getTotalTabCount=function(){return this.getUnsortedLoadedTabs().length};c.getTabsForDockOldestFirst=function(){return this.getLoadedTabs().slice(0,this.getNumDockTabs())};c.getTabsForDockNewestFirst=function(){return this.getTabsForDockOldestFirst().slice().reverse()};c.getTabsForMenuOldestFirst=function(){return this.getLoadedTabs().slice(this.getNumDockTabs())};c.getTabsForMenuNewestFirst=function(){return this.getLoadedTabs().slice(this.getNumDockTabs()).reverse()};c.$4=function(){var a=this,b=this.getLoadedTabs().length;if(b>h){b=b-h;b=this.getTabsForMenuOldestFirst().slice(0,b);b.map(function(a){return a.getTabID()}).forEach(function(b){return a.deleteTab(b)})}};c.$5=function(a){return this.getLoadedTabs().indexOf(a)};return a}();e.exports=new a()}),null);
__d("ConversationNub",["csx","cx","Arbiter","ConversationNubHeader","ConversationNubTabState","ConversationNubTabsUpdateEventController","ConversationNubUtils","CSS","DOM","EventListener","NotificationUserActions","SubscriptionsHandler","UFIComposerIsTypingStore","URI","clearTimeout","containsNode","debounce","guid","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("ConversationNubTabsUpdateEventController").minimizeAndInformTabUpdate,j=b("ConversationNubTabsUpdateEventController").popOutAndInformTabUpdate,k=b("ConversationNubTabState"),l=10,m=500,n=100;a=function(){__p&&__p();a.createDefaultState=function(a,c,d,e,f,g){return{tabID:a,permalinkURI:c!=null?new(b("URI"))(c):null,ftID:d,notifAlertID:e,notificationType:f,title:g,keepAtBottom:!1,isTabRaised:!1,isBlinkingUnread:!1,badgeCount:0,allSeenNewComments:{},unseenCommentsSinceLastCleared:{},hasFakeInitBadge:!1}};function a(a,c,d,e,f,g){__p&&__p();var h=this;f===void 0&&(f=!1);g===void 0&&(g=!1);this.$13=!1;this.$14=!1;this.$1=a;this.$12=c;this.$5=b("guid")();this.$7=null;this.$8=!1;this.$9=null;this.$10=f;this.$11=g;this.$15=e;this.$6=new(b("SubscriptionsHandler"))();this.$16();this.$17();d!=null&&k.modifyTabState(this.$12,function(a){d?a.hasFakeInitBadge=!1:(a.hasFakeInitBadge=!0,h.$18(1),h.$19(!0))});this.$20()}var c=a.prototype;c.$20=function(){this.$21(),this.$22(),b("ConversationNubUtils").informShouldRecheckTabVisibility(this),this.forceReflow()};c.getPersistentState=function(){return k.getTabState(this.$12)};c.getPersistentStateIfExists=function(){return k.getTabStateIfExists(this.$12)};c.$16=function(){__p&&__p();var a=this.$23();if(a){this.$6.addSubscriptions(b("EventListener").listen(a,"click",this.$24.bind(this)),b("EventListener").listen(a,"mouseenter",this.$25.bind(this)),b("EventListener").listen(a,"mouseleave",this.$26.bind(this)));a=b("ConversationNubUtils").getCloseButtonElem(a);a&&b("ConversationNubUtils").addCloseButtonListeners(a,this.$6,this.$27.bind(this))}a=this.$28();a&&(k.modifyTabState(this.$12,function(a){a.keepAtBottom=!0}),this.$6.addSubscriptions(b("EventListener").listen(a,"scroll",b("debounce")(this.$29.bind(this),n)),b("Arbiter").subscribe("reflow",this.$30.bind(this))));a=this.$31();a&&this.$6.addSubscriptions(b("EventListener").listen(a,"focusin",this.$32.bind(this,!0)),b("EventListener").listen(a,"focusout",this.$32.bind(this,!1)))};c.$17=function(){__p&&__p();var a=this,c=this.$33();if(!c){this.$2=null;return}var d=function(){var b=a.getPersistentState();return{permalinkURI:b.permalinkURI,ftID:b.ftID,tabID:b.tabID}};c=new(b("ConversationNubHeader"))(c,d);this.$6.addSubscriptions(c.subscribe("closeButton",this.$27.bind(this)),c.subscribe("showMenu",this.$34.bind(this)),c.subscribe("hideMenu",this.$35.bind(this)),c.subscribe("minimizeButton",this.$36.bind(this,!0)),c.subscribe("clickHeader",this.$36.bind(this,!0)),c.subscribe("menuPermalinkClick",this.$36.bind(this,!1)),b("UFIComposerIsTypingStore").addListener(function(){var c=a.getPersistentStateIfExists();if(!c)return;var d=a.$14;c=b("UFIComposerIsTypingStore").getValueFor(c.ftID);a.$14=c===!0;d!==a.$14&&b("ConversationNubTabsUpdateEventController").informTabsUpdated()}));this.$2=c};c.$33=function(){return this.$1&&b("DOM").scry(this.$1,".fbNubFlyoutTitlebar")[0]};c.$23=function(){return this.$1&&b("DOM").scry(this.$1,".fbNubButton")[0]};c.$28=function(){!this.$3&&this.$1&&(this.$3=b("DOM").scry(this.$1,".uiScrollableAreaWrap")[0]);return this.$3};c.$31=function(){!this.$4&&this.$1&&(this.$4=b("DOM").scry(this.$1,".fbNubFlyoutBodyContent")[0]);return this.$4};c.$37=function(){var a=this.$23();return a?b("DOM").scry(a,"._37op")[0]:null};c.$27=function(){b("ConversationNubUtils").informShouldCloseTab(this.$12,this.getFeedbackTargetID(),b("ConversationNubUtils").CLOSE_REASON_TAB_X_OUT)};c.$36=function(a){i(this,a)};c.$34=function(){this.$1&&b("CSS").addClass(this.$1,"_1uw3")};c.$35=function(){this.$1&&b("CSS").removeClass(this.$1,"_1uw3")};c.$24=function(){this.getPersistentState().isTabRaised?i(this,!0):j(this,!0)};c.$25=function(){this.getPersistentState().isBlinkingUnread&&(this.$9=new Date())};c.$26=function(){var a=this.$9;if(a&&this.getPersistentState().isBlinkingUnread){var b=new Date();b-a>=m&&this.$19(!1)}this.$9=null};c.$38=function(){var a=this.$28();if(a){var b=a.scrollHeight;b>0&&!this.$39(a)&&(this.$8=!0,a.scrollTop=b)}};c.$39=function(a){a=a||this.$28();return!!(a&&a.scrollTop>=a.scrollHeight-a.clientHeight-l)};c.$29=function(){var a=this;if(!k.getTabStateIfExists(this.$12)||!this.getPersistentState().isTabRaised)return;k.modifyTabState(this.$12,function(c){c.keepAtBottom=a.$39(),b("ConversationNubUtils").informShouldRecheckTabVisibility(a)});this.$8||this.clearJewelNotifications();this.$8=!1};c.$32=function(a){if(this.$13===a)return;this.$13=a;this.$13&&this.clearJewelNotifications();b("ConversationNubTabsUpdateEventController").informTabsUpdated()};c.getIsFocused=function(){return this.$13};c.getPageID=function(){return this.$15};c.getHasText=function(){return this.$14};c.$30=function(){var a=this,c=this.getPersistentState();if(!c.isTabRaised)return;c.keepAtBottom&&(this.$38(),this.$7&&b("clearTimeout")(this.$7),this.$7=b("setTimeoutAcrossTransitions")(function(){c.keepAtBottom&&a.$38()},100))};c.$18=function(a){var b=this;k.modifyTabState(this.$12,function(c){c.badgeCount=a,b.$21()})};c.$19=function(a){var b=this;k.modifyTabState(this.$12,function(c){c.isBlinkingUnread=a,b.$22()})};c.$21=function(){var a=this.$37();if(!a)return;var c=this.getPersistentState().badgeCount,d=c>0;d?(b("DOM").setContent(a,c),b("CSS").show(a)):(b("CSS").hide(a),b("DOM").setContent(a,c))};c.$22=function(){if(this.$1){var a=this.getPersistentState().isBlinkingUnread;this.$1&&b("CSS").conditionClass(this.$1,"_53tf",a)}};c.getRootDOM=function(){return this.$1};c.getShouldShowIntroNux=function(){return this.$10};c.getShouldShowHideNux=function(){return this.$11};c.getTabID=function(){return this.$12};c.getNotificationPayloadAlertID=function(){return this.getPersistentState().notifAlertID};c.getNotificationType=function(){return this.getPersistentState().notificationType};c.setNotificationType=function(a){k.modifyTabState(this.$12,function(b){b.notificationType=a})};c.getFeedbackTargetID=function(){return this.getPersistentState().ftID};c.getPermalinkURI=function(){return this.getPersistentState().permalinkURI};c.getTitle=function(){return this.getPersistentState().title};c.getBadgeCount=function(){return this.getPersistentState().badgeCount};c.getIsRaised=function(){return this.getPersistentState().isTabRaised};c.getSessionID=function(){return this.$5};c.markCommentsAsSeenWithoutBadging=function(a){k.modifyTabState(this.$12,function(b){a.forEach(function(a){b.allSeenNewComments[a]=!0})})};c.attemptAddNewCommentsToBadge=function(a){__p&&__p();var b=this;k.modifyTabState(this.$12,function(c){__p&&__p();a.forEach(function(a){if(c.allSeenNewComments[a])return;c.allSeenNewComments[a]=!0;c.unseenCommentsSinceLastCleared[a]=!0});var d=Object.keys(c.unseenCommentsSinceLastCleared).length;c.hasFakeInitBadge&&(d+=1);var e=c.badgeCount;b.$18(d);b.$19(d>0&&d>e)})};c.clearBadge=function(){k.clearTabNotifications(this.$12),this.$21(),this.$22()};c.clearJewelNotifications=function(){var a=this.getNotificationPayloadAlertID();a!=null&&b("NotificationUserActions").markNotificationsAsRead([a])};c.popOutAndInformTabUpdate=function(){this.popOut(),b("ConversationNubTabsUpdateEventController").informTabsUpdated()};c.popOut=function(){var a=this;k.modifyTabState(this.$12,function(c){a.$1&&b("CSS").addClass(a.$1,"_5r93"),c.isTabRaised=!0,a.clearBadge(),c.keepAtBottom&&a.$38()})};c.minimize=function(){var a=this;k.modifyTabState(this.$12,function(c){a.$1&&b("CSS").removeClass(a.$1,"_5r93"),c.isTabRaised=!1,a.$2&&a.$2.hideMenu(),a.clearBadge()})};c.forceReflow=function(){this.$30()};c.isFormForThisUFI=function(a){return this.$1&&b("containsNode")(this.$1,a)};c.destroy=function(){this.$6.release(),this.$2&&this.$2.destroy(),this.$2=null,this.$7&&b("clearTimeout")(this.$7),this.minimize(),this.$1&&(b("DOM").remove(this.$1),b("Arbiter").inform("ConversationNub/destroy",{root:this.$1}),this.$1=null)};return a}();e.exports=a}),null);
__d("XConversationNubActionTakenController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/conversation/nub_story/action_taken/",{})}),null);
__d("ConversationNubActionTakenReporter",["Arbiter","AsyncRequest","ConversationNubUtils","PinnedConversationNubsActionTaken","SubscriptionsHandler","XConversationNubActionTakenController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){__p&&__p();var a=this;this.$2=function(c,d){d.tabID;c=d.ftID;d.tabState;d.sessionID;d=d.reason;(d===b("ConversationNubUtils").CLOSE_REASON_TAB_X_OUT||d===b("ConversationNubUtils").CLOSE_REASON_OVERFLOW_X_OUT||d===b("ConversationNubUtils").CLOSE_REASON_UNPIN)&&a.$3(c,b("PinnedConversationNubsActionTaken").TAB_CLOSED_BY_USER)};this.$1=new(b("SubscriptionsHandler"))();this.$1.addSubscriptions(b("Arbiter").subscribe(b("ConversationNubUtils").CLOSE_TAB_EVENT,this.$2))}var c=a.prototype;c.destroy=function(){this.$1.release()};c.$3=function(a,c){var d=b("XConversationNubActionTakenController").getURIBuilder().getURI();new(b("AsyncRequest"))().setURI(d).setMethod("POST").setData({ft_id:a,action:c}).setAllowCrossPageTransition(!0).send()};return a}();e.exports=a}),null);
__d("ConversationNubHeader",["csx","ArbiterMixin","Bootloader","ConversationNubUtils","DOM","Event","EventListener","Keys","SubscriptionsHandler","ifRequired","mixin"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function h(a,c){return b("EventListener").listen(a,"keydown",function(a){b("Event").getKeyCode(a)===b("Keys").RETURN&&c(a)})}a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d){__p&&__p();var e;e=a.call(this)||this;e.$ConversationNubHeader6=!1;e.$ConversationNubHeader1=c;e.$ConversationNubHeader3=d;e.$ConversationNubHeader4=null;e.$ConversationNubHeader5=!1;e.$ConversationNubHeader2=new(b("SubscriptionsHandler"))();e.$ConversationNubHeader7();return e}var d=c.prototype;d.$ConversationNubHeader7=function(){var a=this.$ConversationNubHeader1;this.$ConversationNubHeader2.addSubscriptions(b("EventListener").listen(a,"click",this.$ConversationNubHeader8.bind(this)));a=b("ConversationNubUtils").getCloseButtonElem(a);a&&b("ConversationNubUtils").addCloseButtonListeners(a,this.$ConversationNubHeader2,this.$ConversationNubHeader9.bind(this));a=this.$ConversationNubHeader10();a&&this.$ConversationNubHeader2.addSubscriptions(b("EventListener").listen(a,"click",this.$ConversationNubHeader11.bind(this)),h(a,this.$ConversationNubHeader11.bind(this)));a=this.$ConversationNubHeader12();a&&this.$ConversationNubHeader2.addSubscriptions(b("EventListener").listen(a,"click",this.$ConversationNubHeader13.bind(this)),b("EventListener").listen(a,"mouseover",this.$ConversationNubHeader14.bind(this)),b("EventListener").listen(a,"focus",this.$ConversationNubHeader15.bind(this)),h(a,this.$ConversationNubHeader16.bind(this)))};d.$ConversationNubHeader12=function(){return b("DOM").scry(this.$ConversationNubHeader1,"._1rf1")[0]};d.$ConversationNubHeader10=function(){return b("DOM").scry(this.$ConversationNubHeader1,"._4a56")[0]};d.$ConversationNubHeader17=function(){return b("ConversationNubUtils").getCloseButtonElem(this.$ConversationNubHeader1)};d.$ConversationNubHeader9=function(){this.inform("closeButton")};d.$ConversationNubHeader11=function(a){a.type==="click"&&a.kill(),this.inform("minimizeButton")};d.$ConversationNubHeader8=function(){this.inform("clickHeader")};d.$ConversationNubHeader18=function(){this.inform("showMenu")};d.$ConversationNubHeader19=function(){this.inform("hideMenu");var a=this.$ConversationNubHeader12();a&&a.blur()};d.$ConversationNubHeader20=function(){this.inform("menuPermalinkClick")};d.$ConversationNubHeader21=function(a){__p&&__p();var c=this;if(this.$ConversationNubHeader4)return;var d=this.$ConversationNubHeader12();if(!d)return;a&&(this.$ConversationNubHeader5=!0);b("Bootloader").loadModules(["React","ReactDOM","ConversationNubHeaderMenu.react"],function(a,b,e){if(c.$ConversationNubHeader6)return;var f=babelHelpers["extends"]({},c.$ConversationNubHeader3(),{onMenuShow:c.$ConversationNubHeader18.bind(c),onMenuHide:c.$ConversationNubHeader19.bind(c),onPermalinkClick:c.$ConversationNubHeader20.bind(c),showOnMount:c.$ConversationNubHeader5});c.$ConversationNubHeader4=b.render(a.createElement(e,f),d)},"ConversationNubHeader")};d.$ConversationNubHeader13=function(a){a.kill(),this.$ConversationNubHeader21(!0)};d.$ConversationNubHeader14=function(){this.$ConversationNubHeader21(!1)};d.$ConversationNubHeader15=function(){this.$ConversationNubHeader21(!1)};d.$ConversationNubHeader16=function(){this.$ConversationNubHeader4?this.$ConversationNubHeader4.toggle():this.$ConversationNubHeader21(!0)};d.hideMenu=function(){this.$ConversationNubHeader4&&this.$ConversationNubHeader4.hide()};d.destroy=function(){this.$ConversationNubHeader6=!0;var a=this.$ConversationNubHeader12();a&&this.$ConversationNubHeader4&&b("ifRequired")("ReactDOM",function(b){b.unmountComponentAtNode(a)});this.$ConversationNubHeader2.release()};return c}(b("mixin")(b("ArbiterMixin")));e.exports=a}),null);
__d("ConversationNubTabsUpdateEventController",["Arbiter","ConversationNubUtils"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="ConversationNub/tabsUpdated",h="ConversationNub/minimizedByUser",i="ConversationNub/maximizedByUser",j=!1;function k(a){j||b("Arbiter").inform(g,a)}function a(a){return b("Arbiter").subscribe(g,function(b,c){j=!0,a(c),j=!1})}function c(a,c){c&&b("Arbiter").inform(h,{tab:a}),a.minimize(),k()}function d(a,c){if(!c&&!b("ConversationNubUtils").allowProgrammaticPopOut())return;c&&b("Arbiter").inform(i,{tab:a});a.popOut();k()}e.exports={TAB_MINIMIZED_BY_USER_EVENT:h,TAB_MAXIMIZED_BY_USER_EVENT:i,informTabsUpdated:k,subscribeToTabsUpdated:a,minimizeAndInformTabUpdate:c,popOutAndInformTabUpdate:d}}),null);
__d("XConversationNubTogglePinController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/conversation/nub_story/toggle_pin/",{ft_id:{type:"String"},pin:{type:"Bool",defaultValue:!1},with_render:{type:"Bool",defaultValue:!1},notif_setting:{type:"Enum",enumType:1}})}),null);
__d("XConversationsToggleController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/conversation/toggle_feature/",{turn_conversations_on:{type:"Bool",defaultValue:!1}})}),null);
__d("isBusinessURI",["isFacebookURI"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("isFacebookURI")(a)&&a.getSubdomain()==="business"}e.exports=a}),null);
__d("isGamesURI",["isFacebookURI"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("isFacebookURI")(a)&&a.getPath().startsWith("/games")}e.exports=a}),null);
__d("ConversationNubUtils",["csx","Arbiter","AsyncRequest","ConversationNubTabState","DOM","Event","EventListener","Keys","NotificationConversationController","URI","XConversationNubTogglePinController","XConversationsToggleController","isBusinessURI","isCanvasAppURI","isGamesURI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ConversationNubTabState"),i=Object.freeze({DISABLE:"disable",ENABLE:"enable"}),j="ConversationNubUtils/closeTab",k="ConversationNubUtils/unpinnedFromHeader",l="ConversationNubUtils/recheckTabVisibility",m="ConversationNubUtils/openPermalinkFromHeader",n="ConversationNubUtils/turnOff",o="ConversationNubUtils/turnOn",p="tab-x-out",q="browser-tab-sync",r="overflow-x-out",s="unpin";function a(a){var b=Object.values(i);return b.find(function(b){return b===a})||null}function t(a,c,d,e){e=e||{};e=e.notif_setting;a=b("XConversationNubTogglePinController").getURIBuilder().setString("ft_id",String(a)).setBool("pin",c);e&&a.setEnum("notif_setting",e);c=a.getURI();e=new(b("AsyncRequest"))().setURI(c).setMethod("POST");d&&e.setAllowCrossPageTransition(!0);e.send()}function u(a){var c=b("XConversationsToggleController").getURIBuilder().setBool("turn_conversations_on",a).getURI();a?H():G();c=new(b("AsyncRequest"))().setURI(c).setAllowCrossPageTransition(!0).setHandler(function(a){a.getPayload().conversationsStatus?H():G()}).setErrorHandler(function(b){a?G():H()}).setMethod("POST");c.send()}function v(a,b,c){t(a,!0,b,c)}function w(a,b,c){t(a,!1,b,c)}function c(a,b){v(a,!1,b)}function d(a,b){w(a,!1,b)}function f(a,b){v(a,!0,b)}function g(a,b){w(a,!0,b)}function x(){u(!1),b("NotificationConversationController").deleteAllTabs()}function y(){u(!0)}function z(a){return b("DOM").scry(a,"._4iz6")[0]}function A(a,c,d){var e=function(){d()};c.addSubscriptions(b("EventListener").listen(a,"click",e),b("EventListener").listen(a,"keydown",function(a){b("Event").getKeyCode(a)===b("Keys").RETURN&&e()}))}function B(){var a=b("URI").getRequestURI();return!b("isCanvasAppURI")(a)&&!b("isBusinessURI")(a)&&!b("isGamesURI")(a)}function C(a,c,d){var e=h.getLoadedTab(a);if(!e)return;var f=e.getPersistentState(),g=e.getSessionID();e=e.getPageID();b("Arbiter").inform(j,{tabID:a,ftID:c,tabState:f,sessionID:g,reason:d,pageID:e})}function D(a){a=h.getLoadedTab(a);if(!a)return;b("Arbiter").inform(k,{tab:a})}function E(a){b("Arbiter").inform(l,{tab:a})}function F(a){if(a==null)return;a=h.getLoadedTab(a);if(!a)return;b("Arbiter").inform(m,{tab:a})}function G(){b("Arbiter").inform(n,{})}function H(){b("Arbiter").inform(o,{})}e.exports={CLOSE_TAB_EVENT:j,UNPIN_FROM_HEADER_EVENT:k,OPEN_PERMALINK_FROM_HEADER_EVENT:m,TURN_CONVERSATIONS_OFF_EVENT:n,TURN_CONVERSATIONS_ON_EVENT:o,CLOSE_REASON_TAB_X_OUT:p,CLOSE_REASON_SYNCHRONIZED_FROM_OTHER_TAB:q,CLOSE_REASON_OVERFLOW_X_OUT:r,CLOSE_REASON_UNPIN:s,coerceToPinRequestNotifSetting:a,sendPinRequest:c,sendUnpinRequest:d,sendPinRequestAcrossTransitions:f,sendUnpinRequestAcrossTransitions:g,getCloseButtonElem:z,addCloseButtonListeners:A,informShouldCloseTab:C,informDidUnpinFromHeaderMenu:D,informShouldRecheckTabVisibility:E,informOpenPermalinkFromHeader:F,allowProgrammaticPopOut:B,turnConversationsOff:x,turnConversationsOn:y}}),null);
__d("ConversationNubPermalinkUtils",["URI","isFacebookURI"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){return a.substr(-1)==="/"?a.slice(0,-1):a}function h(a,b){a=a.getPath();b=b.getPath();return g(a)===g(b)}function i(a,b,c){a=a.getQueryData();b=b.getQueryData();a=a[c];b=b[c];return a==null&&b==null?!0:a===b}function a(a){var c=new(b("URI"))(window.location.href);return c&&a&&b("isFacebookURI")(c)&&b("isFacebookURI")(a)&&h(c,a)&&i(c,a,"fbid")&&i(c,a,"story_fbid")}e.exports={isOnPermalink:a}}),null);
__d("ConversationNubViewportManager",["DockTabsViewportCalculator","DockTabsViewportPinnedConversationTabUtils"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("DockTabsViewportPinnedConversationTabUtils").getMinRequiredWidthForFirstConvoTab;a=function(){__p&&__p();function a(a,c,d){var e=this;this.$1=a;this.$3=c;this.$2=b("DockTabsViewportCalculator").getInstance(this.$1);this.$2&&this.$2.registerPinnedConvoTabCallbacks(babelHelpers["extends"]({},d,{pinnedConvoTabStateGetter:function(){return e.$3}}))}var c=a.prototype;c.getNumDockTabsToShow=function(a){return this.getCouldFitAtLeastOneDockTab(a)?1:0};c.getCouldFitAtLeastOneDockTab=function(a){var b=g();return b<=a};c.forceRecalculatePinnedConvoTabs=function(a){this.$2&&this.$2.forceRecalculatePinnedConvoTabs(a)};return a}();e.exports=a}),null);
__d("ConversationNubVisibilityDedupeUtils",["Bootloader","emptyFunction","ifRequired"],(function(a,b,c,d,e,f){"use strict";function a(a){b("Bootloader").loadModules(["UFICommentVisibilityStore"],a,"ConversationNubVisibilityDedupeUtils")}function c(a){return b("ifRequired")("UFICommentVisibilityStore",function(b){return b.isFeedbackTargetVisible(a)},b("emptyFunction").thatReturnsFalse)}e.exports={bootloadUFIVisibilityModule:a,isFeedbackTargetVisible:c}}),null);
__d("XNotificationNubStoryController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/conversation/nub_story/",{notif_alert_id:{type:"String"},notif_id:{type:"Int"},ft_id:{type:"String"},force_minimized:{type:"Bool",defaultValue:!1}})}),null);
__d("NotificationConversationController",["csx","cx","Arbiter","AsyncRequest","Bootloader","ConversationNub","ConversationNubActionTakenReporter","ConversationNubPermalinkUtils","ConversationNubTabState","ConversationNubTabsUpdateEventController","ConversationNubUtils","ConversationNubViewportManager","ConversationNubVisibilityDedupeUtils","CSS","DOM","PinnedConversationNubsConfig","SubscriptionsHandler","URI","XNotificationNubStoryController","ge","ifRequired","nullthrows"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("ConversationNubVisibilityDedupeUtils").isFeedbackTargetVisible,j=1,k=b("ConversationNubTabState"),l=Object.create(null),m=null,n=null,o=null,p=null,q=null,r=null,s=!1,t=null,u=null,v=null,w=Object.create(null);function x(){n||(n=b("DOM").scry(b("ge")("pagelet_dock"),"._1mw-")[0]);return n}function y(){if(!o){var a=x();a&&(o=b("DOM").scry(a,"._1tvj")[0])}return o}function z(){if(!p){var a=x();a&&(p=b("DOM").scry(a,"._2ikx .fbNubButton")[0])}return p}a=function(){__p&&__p();function a(){}var c=a.prototype;c.init=function(){__p&&__p();var a=this;if(s)return;s=!0;var c=new(b("SubscriptionsHandler"))();c.addSubscriptions(b("ConversationNubTabsUpdateEventController").subscribeToTabsUpdated(this.$2.bind(this)),b("Arbiter").subscribe(b("ConversationNubUtils").CLOSE_TAB_EVENT,function(b,c){b=c||{};c=b.tabID;c&&a.$3(c)}));this.$1=new(b("ConversationNubActionTakenReporter"))();t=c};c.$4=function(a){a=m?m.getNumDockTabsToShow(a):j;k.setMaxDockTabs(a)};c.$5=function(a,c){this.$4(a);if(c){var d=c.tabToPromote;c=c.tabToOpenIfInDock;d&&!k.isTabInDock(d.getTabID())&&k.moveTabToDockLeft(d.getTabID());b("ConversationNubUtils").allowProgrammaticPopOut()&&c&&k.isTabInDock(c.getTabID())&&c.popOut()}this.$6(a)};c.$2=function(a){m&&m.forceRecalculatePinnedConvoTabs(a)};c.$6=function(a){__p&&__p();var c=k.getTotalTabCount(),d=k.getNumDockTabs();a=m?m.getCouldFitAtLeastOneDockTab(a):!1;a=c>0&&a;d=d<c&&a;c=x();c&&(b("CSS").conditionClass(c,"_1tvf",a),b("CSS").conditionClass(c,"_1dex",d),b("CSS").conditionClass(c,"_1tvi",d));a=b("PinnedConversationNubsConfig").pinnedToLeft?k.getTabsForDockOldestFirst():k.getTabsForDockNewestFirst();a.forEach(function(a){a.getIsRaised()&&a.clearBadge()});c=k.getTabsForMenuNewestFirst();this.$7(a);this.$8(c)};c.handleNotificationsRead=function(a){this.init();k.getUnsortedLoadedTabs().forEach(function(b){var c=b.getNotificationPayloadAlertID();c&&a[c]&&b.clearBadge()});k.getUnloadedTabs().forEach(function(b){b.notifAlertID&&a[b.notifAlertID]&&k.clearTabNotifications(b.tabID)});var b=k.getTabsForMenuNewestFirst();this.$8(b)};c.handleNewNotificationFromGraphQL=function(a,c){this.init();a=b("nullthrows")(a);var d=a.tab_id,e=a.notification,f=a.feedback_target_id;a=a.permalink_uri;e=b("nullthrows")(e);var g=e.notif_id,h=e.alert_id;e=e.notif_type;this.$9(b("nullthrows")(d),b("nullthrows")(g),b("nullthrows")(f),b("nullthrows")(h),a?new(b("URI"))(a):null,c,e)};c.$9=function(a,c,d,e,f,g,h){e=b("XNotificationNubStoryController").getURIBuilder().setString("notif_alert_id",e).setInt("notif_id",c);this.$10(d,g);this.$11(a,d,h,f,e)};c.$10=function(a,b){w[a]||(w[a]=b)};c.$11=function(a,c,d,e,f){__p&&__p();if(l[a])return;var g=k.getLoadedTab(a);if(g){d&&g.setNotificationType(d);return}(b("ConversationNubPermalinkUtils").isOnPermalink(e)||i(c))&&f.setBool("force_minimized",!0);l[a]=!0;new(b("AsyncRequest"))().setURI(f.getURI()).setAllowCrossPageTransition(!0).setFinallyHandler(function(){delete l[a]}).send()};c.$12=function(a){__p&&__p();var c=!0;k.getUnsortedLoadedTabs().forEach(function(b){var d=b.getFeedbackTargetID(),e=a[d];e=e?Object.keys(e):[];if(e.length){var f=b.getBadgeCount();i(d)?(b.markCommentsAsSeenWithoutBadging(e),b.clearBadge()):b.attemptAddNewCommentsToBadge(e);d=b.getBadgeCount();f!==d&&(c=!0)}});c&&b("ConversationNubTabsUpdateEventController").informTabsUpdated()};c.$13=function(a,c,d){if(v){v.addTab(a,d);delete w[a.getPersistentState().ftID];return}b("Bootloader").loadModules(["ConversationNubLogger"],function(b){v||(v=new b(c)),v.addTab(a,d),delete w[a.getPersistentState().ftID]},"NotificationConversationController")};c.$14=function(){var a=this;if(u)return;b("Bootloader").loadModules(["ConversationNubUFICentralUpdateManager"],function(b){if(u)return;u=new b(a.$12.bind(a))},"NotificationConversationController")};c.$7=function(a){var c=y();if(!c)return;b("Bootloader").loadModules(["React","ReactDOM","ConversationNubDockedTabGroup.react"],function(b,d,e){r=d.render(b.createElement(e,{dockTabs:a}),c)},"NotificationConversationController")};c.$15=function(a){a.popOut(),b("ConversationNubTabsUpdateEventController").informTabsUpdated({tabToPromote:a})};c.$8=function(a){var c=this,d=z();if(!d)return;b("Bootloader").loadModules(["React","ReactDOM","ConversationNubCollapsedSelectorMenu.react"],function(b,e,f){q=e.render(b.createElement(f,{menuTabs:a,onTabSelected:c.$15}),d)},"NotificationConversationController")};c.$16=function(){if(!m){var a=x();if(a){var c={onAvailableWidthChanged:this.$5.bind(this)};m=new(b("ConversationNubViewportManager"))(a,k,c)}}};c.storyFromServer=function(a,c){__p&&__p();s||this.init();var d=c.attempt_open_on_init,e=c.ft_id,f=c.init_without_badge,g=c.notif_alert_id,h=c.notification_type,j=c.permalink_uri,l=c.promote_on_init,m=c.tab_add_source,n=c.tab_id,o=c.title,p=c.should_show_intro_nux,q=c.should_show_hide_nux;c=c.page_id;var r=k.getLoadedTab(n);if(r){(l||d)&&b("ConversationNubTabsUpdateEventController").informTabsUpdated({tabToPromote:l?r:null,tabToOpenIfInDock:d?r:null});return}f=f||i(e);r=k.getTabStateIfExists(n);if(r)f=null;else{r=b("ConversationNub").createDefaultState(n,j,e,g,h,o);k.addTabState(r)}j=new(b("ConversationNub"))(a,n,f,c,Boolean(p),Boolean(q));k.addLoadedTab(n,j);d=d||j.getPersistentState().isTabRaised;this.$14();this.$16();b("ConversationNubTabsUpdateEventController").informTabsUpdated({tabToPromote:l?j:null,tabToOpenIfInDock:d?j:null});g=w[e]||m||"unknown";this.$13(j,k,g)};c.deleteAllTabs=function(){k.deleteAllTabs(),b("ConversationNubTabsUpdateEventController").informTabsUpdated()};c.$3=function(a){a=k.deleteTab(a);a&&b("ConversationNubTabsUpdateEventController").informTabsUpdated()};c.unsubscribe=function(){t&&t.release(),t=null,v&&v.destroy(),v=null,u&&u.destroy(),u=null,this.$1.destroy(),b("ifRequired")("ReactDOM",function(a){var b=z();q&&b&&a.unmountComponentAtNode(b);b=y();r&&b&&a.unmountComponentAtNode(b)})};return a}();e.exports=new a()}),null);
__d("PinnedConversationTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:PinnedConversationLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:PinnedConversationLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:PinnedConversationLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setAttemptOpenOnInit=function(a){this.$1.attempt_open_on_init=a;return this};c.setBadgeCount=function(a){this.$1.badge_count=a;return this};c.setClientEventTimeMs=function(a){this.$1.client_event_time_ms=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setFtID=function(a){this.$1.ft_id=a;return this};c.setIsRaised=function(a){this.$1.is_raised=a;return this};c.setNotificationType=function(a){this.$1.notification_type=a;return this};c.setPageID=function(a){this.$1.page_id=a;return this};c.setPromoteOnInit=function(a){this.$1.promote_on_init=a;return this};c.setReason=function(a){this.$1.reason=a;return this};c.setTabID=function(a){this.$1.tab_id=a;return this};c.setTabSessionID=function(a){this.$1.tab_session_id=a;return this};c.setTabsInDock=function(a){this.$1.tabs_in_dock=a;return this};c.setTabsInMenu=function(a){this.$1.tabs_in_menu=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};c.setWindowInnerHeight=function(a){this.$1.window_inner_height=a;return this};c.setWindowInnerWidth=function(a){this.$1.window_inner_width=a;return this};return a}();c={attempt_open_on_init:!0,badge_count:!0,client_event_time_ms:!0,event:!0,ft_id:!0,is_raised:!0,notification_type:!0,page_id:!0,promote_on_init:!0,reason:!0,tab_id:!0,tab_session_id:!0,tabs_in_dock:!0,tabs_in_menu:!0,time:!0,vc:!0,weight:!0,window_inner_height:!0,window_inner_width:!0};e.exports=a}),null);
__d("ConversationNubLogger",["Arbiter","ConversationNubTabsUpdateEventController","ConversationNubUtils","PinnedConversationTypedLogger","SubscriptionsHandler"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(a){this.$1=new(b("SubscriptionsHandler"))(),this.$2=a,this.$3()}var c=a.prototype;c.$3=function(){__p&&__p();var a=this;this.$1.addSubscriptions(b("Arbiter").subscribe(b("ConversationNubUtils").CLOSE_TAB_EVENT,function(c,d){c=d.tabState;var e=d.sessionID;d=d.reason;d=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_close").setReason(d);a.$4(d,c,e)}));this.$1.addSubscriptions(b("Arbiter").subscribe(b("ConversationNubUtils").UNPIN_FROM_HEADER_EVENT,function(c,d){c=d.tab;d=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_hide");a.$5(d,c)}));this.$1.addSubscriptions(b("Arbiter").subscribe(b("ConversationNubTabsUpdateEventController").TAB_MAXIMIZED_BY_USER_EVENT,function(c,d){c=d.tab;d=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_maximize");a.$5(d,c)}));this.$1.addSubscriptions(b("Arbiter").subscribe(b("ConversationNubTabsUpdateEventController").TAB_MINIMIZED_BY_USER_EVENT,function(c,d){c=d.tab;d=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_minimize");a.$5(d,c)}));this.$1.addSubscriptions(b("Arbiter").subscribe(b("ConversationNubUtils").OPEN_PERMALINK_FROM_HEADER_EVENT,function(c,d){c=d.tab;d=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_open_permalink_from_header");a.$5(d,c)}))};c.$5=function(a,b){a.setTabID(b.getTabID()).setPageID(b.getPageID()).setClientEventTimeMs(Date.now()).setTabsInMenu(this.$2.getNumMenuTabs()).setTabsInDock(this.$2.getNumDockTabs()).setWindowInnerWidth(window.innerWidth).setWindowInnerHeight(window.innerHeight);a.setFtID(b.getFeedbackTargetID()).setIsRaised(b.getIsRaised()).setBadgeCount(b.getBadgeCount()).setTabSessionID(b.getSessionID());b=b.getNotificationType();b!=null&&a.setNotificationType(b);a.log()};c.$4=function(a,b,c){a.setTabID(b.tabID).setClientEventTimeMs(Date.now()).setTabsInMenu(this.$2.getNumMenuTabs()).setTabsInDock(this.$2.getNumDockTabs()).setWindowInnerWidth(window.innerWidth).setWindowInnerHeight(window.innerHeight),a.setFtID(b.ftID).setIsRaised(b.isTabRaised).setBadgeCount(b.badgeCount).setTabSessionID(c),b.notificationType!=null&&a.setNotificationType(b.notificationType),a.log()};a.subscriptionTriggered=function(a){new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_subscription_triggered").setReason(a).log()};c.addTab=function(a,c){c=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_add").setReason(c);this.$5(c,a)};c.destroy=function(){this.$1.release()};return a}();e.exports=a}),null);
__d("ConversationNotificationListeners",["Bootloader","ConversationNubAddTabSource","ConversationNubLogger","FacebookWebNotificationsSubscription","NotificationConstants","NotificationUpdates","once"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("NotificationConstants").PayloadSourceType.LIVE_SEND;function h(){b("NotificationUpdates").subscribe("update-notifications",function(a,c){c.payloadsource===g&&c.readState&&Object.keys(c.readState).length&&b("Bootloader").loadModules(["NotificationConversationController"],function(a){a.handleNotificationsRead(c.readState)},"ConversationNotificationListeners")})}var i=b("once")(function(){h(),b("FacebookWebNotificationsSubscription").subscribe({event:"NEW_PINNED_CONVERSATION",callback:function(a){b("ConversationNubLogger").subscriptionTriggered("graphql"),b("Bootloader").loadModules(["NotificationConversationController"],function(c){c.handleNewNotificationFromGraphQL(a,b("ConversationNubAddTabSource").NOTIFICATION)},"ConversationNotificationListeners")}})});e.exports={initialize:function(){i()}}}),null);
__d("FBPaymentsDialogContainerMount",["FBPaymentsDialogContainer.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";a={mount:function(a){b("ReactDOM").render(b("React").createElement(b("FBPaymentsDialogContainer.react"),null),a)}};e.exports=a}),null);
__d("FBRTCExperimentName",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({USE_H264:"rtc_browser_use_h264",USE_VP9:"rtc_browser_use_vp9",ENABLE_SCREEN_SHARING:"webrtc_enable_screen_sharing",INCOMING_CALL_EXPERIMENTS:"rtweb_incoming_call_experiments",SHOW_CHAT_WHILE_IN_CALL:"rtc_www_show_chat_while_in_call",MW_AUDIO_FALLBACK:"rtc_www_mw_audio_fallback",LARGER_SELF_VIEW:"rtc_www_larger_self_view",VIDEO_CHAT_FILTERS:"rtc_www_video_chat_filters",P2P_END_CALL_SCREEN:"rtc_www_p2p_end_call_screen",CALL_UNIFICATION:"rtc_www_call_unification",TURNOFF_CAMERA_WHEN_FACEMUTE:"turnoff_camera_when_facemute",DIVE_BAR_RECENT_CALLS:"rtc_www_dive_bar_recent_calls",FB_PROFILE_RTC_BUTTONS:"rt_web_fb_profile_rtc_buttons",MW_VIDEO_QUALITY:"rtc_www_mw_video_quality",MEDIA_QUALITY_H2_2018:"rtc_www_media_quality_h2_2018",VIDEO_ESCALATION:"rtweb_video_escalation",NEW_MUTE_ICON_LAYOUT:"rtcwww_muteicon",RTC_USE_SCOTCH:"rtc_www_scotch"})}),null);
__d("FBRTCExperiment",["FBRTCExperimentName","FBRTCExperimentsConfig","QE2Logger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();a.gen=function(c){var d={params:{},auto_exposure:!1,in_experiment:!1};d=b("FBRTCExperimentsConfig")[c]||d;c=new a(c,d);return c};a.getIncomingCallExperiments=function(){return a.gen(b("FBRTCExperimentName").INCOMING_CALL_EXPERIMENTS)};a.getMediaQualityExperiments=function(){return a.gen(b("FBRTCExperimentName").MEDIA_QUALITY_H2_2018)};a.getNewMuteIconLayoutExperiments=function(){return a.gen(b("FBRTCExperimentName").NEW_MUTE_ICON_LAYOUT)};a.getScotchExperiment=function(){return a.gen(b("FBRTCExperimentName").RTC_USE_SCOTCH)};function a(a,b){this.$1=a,this.$2=b}var c=a.prototype;c.$3=function(){this.$2.auto_exposure&&this.logExposure()};c.logExposure=function(){this.$2.in_experiment&&b("QE2Logger").logExposureForUser(this.$1)};c.getParam=function(a,b){if(this.$2.in_experiment){this.$3();a=this.$2.params[a];if(a!==void 0)return String(a)}return b};c.getInt=function(a,b){if(this.$2.in_experiment){this.$3();if(this.$2.params[a]!==void 0)return parseInt(this.$2.params[a],10)}return b};c.getBool=function(a,b,c){c===void 0&&(c=!0);var d=this.$2.params;if(this.$2.in_experiment){c&&this.$3();if(d[a]!==void 0)return d[a]==="1"||d[a]===1||d[a]==="true"||d[a]===!0}return b};return a}();e.exports=a}),null);
__d("FBRTCIceStatsParser",[],(function(a,b,c,d,e,f){__p&&__p();var g=null;a=function(){"use strict";__p&&__p();function a(){}a.getInstance=function(){g||(g=new a());return g};var b=a.prototype;b.extractIceInfo=function(a){var b=[];a=a.split("\r\n");for(var c=0;c<a.length;c++){var d=a[c];this.$1(d)&&b.push({gen:this.$2(d),type:this.$3(d)})}return b};b.$1=function(a){return a.indexOf("candidate:")>-1};b.$2=function(a){var b=0;a=a.match(/generation (\d+)/);a&&(b=parseInt(a[1],10));return b};b.$3=function(a){a=a.match(/typ (host|relay|srflx|prflx)/);if(a)return a[1];else return"unknown"};return a}();e.exports=a}),null);
__d("FBRTCLocalUploadLogLevel",["CurrentUser","FBRTCConstants"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCConstants").UploadLogLevel,h={getUploadLogLevel:function(a){return Math.max(h.getLocalUploadLogLevel(),a)},getLocalUploadLogLevel:function(){return b("CurrentUser").isEmployee()?g.LL_DEBUG:g.LL_NONE}};e.exports=h}),null);
__d("FBRTCMediaMetricTracker",["performanceNow"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={count:0,current:-1,first:-1,min:-1,max:-1,mean:-1,median:-1,startedTime:-1,total:-1,updatedTime:-1};a=function(){__p&&__p();function a(){this.$1={},this.$2={},this.$3={}}var c=a.prototype;c.getVideoStreamReportKeys=function(){return Object.keys(this.$3)};c.getJitterStreamReportKey=function(){return Object.keys(this.$1)};c.getAudioStreamReportKeys=function(){return Object.keys(this.$2)};c.addJitterBufferDelay=function(a,b){b!==null&&b!==void 0&&(this.$1[a]||(this.$1[a]=[]),this.$1[a].push(b))};c.setVideoMetric=function(a,b,c){c!==null&&c!==void 0&&(this.$3[a]||(this.$3[a]={}),this.$3[a][b]=this.$4(this.$3[a][b],c))};c.$4=function(a,c){__p&&__p();if(a!==null&&a!==void 0){a.current=c;a.updatedTime=b("performanceNow")();a.total+=c;a.count+=1;a.min=Math.min(a.min,c);a.max=Math.max(a.max,c);a.mean=a.total/a.count;return a}else return{min:c,max:c,total:c,count:1,mean:c,first:c,startedTime:b("performanceNow")(),current:c,updatedTime:b("performanceNow")()}};c.getVideoMetric=function(a,b){return this.$3[a]?this.$3[a][b]:null};c.addMetricStat=function(a,b,c){c!==null&&c!==void 0&&(this.$2[a]||(this.$2[a]={}),this.$2[a][b]=this.$4(this.$2[a][b],c))};c.getMetricStats=function(a,b){return!this.$2[a]?null:this.$2[a][b]};c.getJitterBufferStats=function(a){__p&&__p();if(!this.$1[a])return g;var b=this.$1[a].length;if(b===0)return g;this.$1[a].sort(function(a,b){return a-b});var c=this.$1[a].reduce(function(a,b){return a+b});if(b%2===0){var d=Math.floor((b-1)/2),e=Math.ceil((b-1)/2);d=(this.$1[a][d]+this.$1[a][e])/2}else d=this.$1[a][(b-1)/2];return{max:this.$1[a][b-1],min:this.$1[a][0],mean:c/b,median:d,total:c,count:b,first:-1,startedTime:-1,current:-1,updatedTime:-1}};c.toJsonString=function(){return JSON.stringify({stats:this.$2,jitterBufferDelays:this.$1,videoMetric:this.$3})};a.fromJsonString=function(b){var c=new a();try{b=JSON.parse(b),b=b}catch(a){return c}b.stats&&(c.$2=b.stats);b.jitterBufferDelays&&(c.$1=b.jitterBufferDelays);b.videoMetric&&(c.$3=b.videoMetric);return c};return a}();e.exports=a}),null);
__d("FBRTCMediaMetricsConst",[],(function(a,b,c,d,e,f){"use strict";a={JITTER:"jitter",ACCELERATE_RATE:"accelerate_rate",DECODING_CNG:"decoding_cng",DECODING_NORMAL:"decoding_normal",DECODING_PLC:"decoding_plc",DECODING_PLC_CNG:"decoding_plc_cng",DISCARD_RATE:"discard_rate",EXPAND_RATE:"expand_rate",PREEMPTIVE_RATE:"preemptive_rate",AUDIO_PACKETS_RECEIVED:"audio_packets_received",AUDIO_PACKETS_RECEIVED_LOST:"audio_packets_received_lost",AUDIO_PACKETS_SENT:"audio_packets_sent",AUDIO_PACKETS_SENT_LOST:"audio_packets_sent_lost",VIDEO_BYTES_RECEIVED:"video_bytes_received",VIDEO_BYTES_SENT:"video_bytes_sent",INBOUND_QP:"inbound_qp",OUTBOUND_QP:"outbound_qp",FRAMES_ENCODED:"frames_encoded",FRAMES_DECODED:"frames_decoded",VIDEOBWE_SEND_BANDWIDTH:"videobwe_send_bandwidth",VIDEOBWE_TRANSMIT_BITRATE:"videobwe_transmit_bitrate",VIDEOBWE_RETRANSMIT_BITRATE:"videobwe_retransmit_bitrate",AUDIO_BYTES_SENT:"audio_bytes_sent",AUDIO_BYTES_RECEIVED:"audio_bytes_received",VIDEO_PKTS_SENT:"video_pkts_sent",VIDEO_PKTS_SEND_LOST:"video_pkts_send_lost",VIDEO_PKTS_RECEIVED:"video_pkts_received",VIDEO_PKTS_RECV_LOST:"video_pkts_receive_lost",AUDIO_RTT_RECEIVED:"audio_rtt_received",AUDIO_RTT_SENT:"audio_rtt_sent"};e.exports=a}),null);
__d("FBRTCCallSummary",["FBRTCConstants","FBRTCExperiment","FBRTCIceStatsParser","FBRTCLocalUploadLogLevel","FBRTCLogger","FBRTCMediaMetricsConst","FBRTCMediaMetricTracker","SiteData","UserAgentData","gkx","performanceNow"],(function(a,b,c,d,e,f){__p&&__p();var g=5*60*1e3,h={CALL_STARTED:"started",SENT_OFFER:"s_o",RECV_OFFER:"r_o",SENT_OFFER_ACK:"s_oack",RECV_OFFER_ACK:"r_oack",SENT_RETRIED_OFFER:"s_o2",RECV_RETRIED_OFFER:"r_o2",SENT_RETRIED_OFFER_ACK:"s_oack2",RECV_RETRIED_OFFER_ACK:"r_oack2",SENT_PRANSWER:"s_pr",RECV_PRANSWER:"r_pr",NETWORK_READY:"network_ready",SENT_ANSWER:"s_a",RECV_ANSWER:"r_a",SENT_ANSWER_ACK:"s_aack",RECV_ANSWER_ACK:"r_aack",SENT_RETRIED_ANSWER:"s_a2",RECV_RETRIED_ANSWER:"r_a2",SENT_RETRIED_ANSWER_ACK:"s_aack2",RECV_RETRIED_ANSWER_ACK:"r_aack2",SENT_OK:"s_ok",RECV_OK:"r_ok",CALL_CONNECTED:"connected",CALL_ENDED:"ended",SENT_JOIN_REQUEST:"s_jreq",RECV_JOIN_RESPONSE:"r_jresp",PROC_JOIN_RESPONSE:"p_jresp",RECV_RING_REQUEST:"r_rreq",SENT_RING_RESPONSE:"s_rresp"},i={FELLBACK_TO_AUDIO:"f_a",MEDIA_REQUESTED:"m_r",MEDIA_SUCCEEDED:"m_s",POPUP_OPENED:"opened",PRESSED_ANSWER:"p_a"},j={ESCALATION_IS_AVAILABLE:"esc_available",USER_INITIATED_REQUEST:"out_started",RECEIVED_INCOMING_REQUEST:"inc_started",REJECTED_INVALID_P2P_STATE:"rej_invalid_state",CONNECTING_TO_MULTIWAY:"u_connecting_mw",CONNECTED_TO_MULTIWAY:"u_connected_mw",PEER_CONNECTING_TO_MULTIWAY:"p_connecting_mw",PEER_CONNECTED_TO_MULTIWAY:"p_connected_mw",READY_TO_ESCALATE:"ready_esc",PEER_FAILED_TO_CONNECT_TO_MULTIWAY:"p_fail_conn",MULTIWAY_CALL_ENDED:"mw_call_ended",TIMED_OUT:"timed_out",PEER_ABORTED:"p_aborted",INTERNAL_ERROR:"internal_err"},k={ESCALATION_INITIATION_BUTTON_CLICKED:"esc_init_button",ESCALATION_APPROVED_BUTTON_CLICKED:"esc_appr_button",ESCALATION_DECLINED_BUTTON_CLICKED:"esc_decl_button",USERMEDIA_REQUEST:"media_req",USERMEDIA_SUCCESS:"media_success",USERMEDIA_FAILURE:"media_fail",SENT_ESC_REQUEST:"s_esc_req",RECV_ESC_REQUEST:"r_esc_req",SENT_ESC_REQUEST_ACK:"s_esc_req_ack",RECV_ESC_REQUEST_ACK:"s_esc_req_ack",SENT_ESC_RESPONSE:"s_esc_rep",RECV_ESC_ACCEPT:"r_esc_accept",RECV_ESC_DECLINE:"r_esc_decl",RECV_ESC_TIMEOUT:"r_esc_timeout"},l=[b("FBRTCMediaMetricsConst").ACCELERATE_RATE,b("FBRTCMediaMetricsConst").DISCARD_RATE,b("FBRTCMediaMetricsConst").EXPAND_RATE,b("FBRTCMediaMetricsConst").PREEMPTIVE_RATE];function a(){var a=b("FBRTCExperiment").getScotchExperiment().getBool("use_scotch",!1,!1);return a?"Zenon":"Old Codebase"}c=function(){"use strict";__p&&__p();a.nullSummary=function(){return new a({peerID:"0",callID:"0",isCaller:!1,callTrigger:"NULL_SUMMARY"})};function a(c){this.peerID=String(c.peerID),this.callID=String(c.callID),this.$2=c.isCaller,this.$1=c.version||a.CURRENT_SUMMARY_VERSION,this.$3=b("FBRTCLocalUploadLogLevel").getLocalUploadLogLevel(),this.$15=new Date().valueOf(),this.$4=c.callTrigger||null,this.$6={},this.$8={},this.$9={},this.$14={},this.$34=null,this.$35=null,this.$36=null,this.$17=0,this.$18=0,this.$33=!1,this.$10={},this.$11={},this.$12={},this.$13={},this.$37=null,this.$5=a.CURRENT_CLIENT_VERSION,this.$20=b("performanceNow")(),this.$16=0,this.$7={},this.$19=this.$20,this.$21=0,this.$22={},this.addExtraInfo(b("FBRTCLogger").Key.DEVICE_INFO,this.$44()),this.$45(),this.$46(),this.$47(),this.$24=b("FBRTCIceStatsParser").getInstance(),this.$43=new(b("FBRTCMediaMetricTracker"))(),this.$23=b("FBRTCLogger").getInstance()}var c=a.prototype;c.toJsonString=function(){this.$18=new Date().valueOf();return JSON.stringify({version:this.$1,peerID:this.peerID,callID:this.callID,isCaller:this.$2,uploadLogLevel:this.$3,callType:this.$29,conferenceName:this.$26,joinWithSID:this.$27,activeConn:this.$25,escP2PCallID:this.$28,serverInfoData:this.$30,localVideoDuration:this.$31,remoteVideoDuration:this.$32,startTime:this.$15,trigger:this.$4,signalingTime:this.$6,escStateTimes:this.$8,applicationEventTime:this.$9,videoEscTimes:this.$14,endCallReason:this.$34,endCallSubreason:this.$35,isRemoteEnded:this.$36,lastUpdatedTime:this.$17,lastSerializedTime:this.$18,unsetOnRetrieve:this.$33,openCount:this.$21,extraInfo:this.$22,gen0IceSentCount:this.$10,gen0IceReceivedCount:this.$11,iceSentCount:this.$12,iceReceivedCount:this.$13,connectionType:this.$37,mediaMetricStats:this.$43.toJsonString(),newSignalingTime:this.$7,accumulatedCallTime:this.$48(),deviceCharged:this.$39,videoReceivedCodec:this.$40,videoSentCodec:this.$41,audioSentCodec:this.$42,relayIP:this.$38,clientVersion:this.$5})};a.fromJsonString=function(c){__p&&__p();try{c=JSON.parse(c)}catch(a){return null}if(c.version<a.OLDEST_SUPPORTED_SUMMARY_VERSION)return null;if(!Object.prototype.hasOwnProperty.call(c,"peerID")||!Object.prototype.hasOwnProperty.call(c,"callID")||!Object.prototype.hasOwnProperty.call(c,"isCaller")||!Object.prototype.hasOwnProperty.call(c,"startTime")||!Object.prototype.hasOwnProperty.call(c,"trigger")||!Object.prototype.hasOwnProperty.call(c,"signalingTime")||!Object.prototype.hasOwnProperty.call(c,"endCallReason")||!Object.prototype.hasOwnProperty.call(c,"isRemoteEnded")||!Object.prototype.hasOwnProperty.call(c,"lastUpdatedTime")||!Object.prototype.hasOwnProperty.call(c,"lastSerializedTime"))return null;var d=new a({peerID:c.peerID,callID:c.callID,isCaller:c.isCaller});d.$1=c.version;d.$3=c.uploadLogLevel;d.$15=c.startTime;d.$4=c.trigger;d.$5=c.clientVersion;d.$6=c.signalingTime;d.$34=c.endCallReason;d.$35=c.endCallSubreason;d.$36=c.isRemoteEnded;d.$17=c.lastUpdatedTime;d.$18=c.lastSerializedTime;d.$27=c.joinWithSID;c.callType&&(d.$29=c.callType);c.conferenceName&&(d.$26=c.conferenceName);c.escP2PCallID&&(d.$28=c.escP2PCallID);c.activeConn&&(d.$25=c.activeConn);c.serverInfoData&&(d.$30=c.serverInfoData);c.localVideoDuration&&(d.$31=c.localVideoDuration);c.remoteVideoDuration&&(d.$32=c.remoteVideoDuration);c.unsetOnRetrieve&&(d.$33=c.unsetOnRetrieve);c.openCount&&(d.$21=c.openCount);c.extraInfo&&(d.$22=c.extraInfo);c.gen0IceSentCount&&(d.$10=c.gen0IceSentCount);c.gen0IceReceivedCount&&(d.$11=c.gen0IceReceivedCount);c.iceSentCount&&(d.$12=c.iceSentCount);c.iceReceivedCount&&(d.$13=c.iceReceivedCount);c.newSignalingTime&&(d.$7=c.newSignalingTime);c.accumulatedCallTime&&(d.$16=c.accumulatedCallTime);c.escStateTimes&&(d.$8=c.escStateTimes);c.applicationEventTime&&(d.$9=c.applicationEventTime);c.videoEscTimes&&(d.$14=c.videoEscTimes);c.mediaMetricStats&&(d.$43=b("FBRTCMediaMetricTracker").fromJsonString(c.mediaMetricStats));c.connectionType&&(d.$37=c.connectionType);c.deviceCharged&&(d.$39=c.deviceCharged);c.videoReceivedCodec!==null&&(d.$40=c.videoReceivedCodec);c.videoSentCodec!==null&&(d.$41=c.videoSentCodec);c.audioSentCodec!==null&&(d.$42=c.audioSentCodec);c.relayIP!==null&&c.relayIP!==void 0&&(d.$38=c.relayIP);return d};a.restoreOrInitialize=function(c,d,e,f,g,i){d=String(d);e=String(e);c=c.retrieveCallSummary(d,e);!c?(c=new a({peerID:d,callID:e,isCaller:f}),g?(c.onFullMessageReceived({msg:g}),c.onOfferAckSent(g)):c.onCallStarted(i||b("FBRTCLogger").Trigger.UNKNOWN),b("FBRTCLogger").getInstance().logError(d,e,"Missing call summary from storage")):c.$33&&(c.$34=null,c.$35=null,c.$36=null,delete c.$6[h.CALL_ENDED],delete c.$7[h.CALL_ENDED],c.$20=0,c.$33=null);return c};a.logSavedSummaries=function(a){__p&&__p();var c=a.getLoggableSummaries(),d=c.length;if(d<=0)return;var e=b("FBRTCLogger").getInstance(),f=[];for(var g=0;g<d;g++){var h=c[g];e.logEndCallSummary(h);f.push({peerID:h.peerID,callID:h.callID})}a.removeCallSummaries(f);e.logToConsole("Logged pending summaries: "+d)};c.logThisSummary=function(a){var c=b("FBRTCLogger").getInstance();a.retrieveCallSummary(this.peerID,this.callID)!=null&&(c.logEndCallSummary(this),a.removeCallSummary(this.peerID,this.callID),c.logToConsole("Logged active summary"))};c.isNull=function(){var b=a.CANONICAL_NULL_SUMMARY;return this.peerID===b.peerID&&this.callID===b.callID&&this.isCaller()===b.isCaller()&&this.getCallTrigger()===b.getCallTrigger()};c.save=function(a){var c=b("performanceNow")(),d=c-this.$19;if(d>g){this.$23.logInfo(this.peerID,this.callID,"Summary too old: "+d);return}a.storeCallSummary(this.peerID,this.callID,this);this.$19=c};c.getVersion=function(){return this.$1};c.getLastUpdatedTime=function(){return this.$17};c.setLastUpdatedTime=function(a){this.$17=a};c.getExtraInfo=function(){return this.$22};c.getCallTrigger=function(){return this.$4};c.addExtraInfo=function(a,b){this.$22[a]=b,this.$47()};c.isCaller=function(){return this.$2};c.isNetworkReady=function(){if(this.$6[h.NETWORK_READY])return!0;else return!1};c.isAnswerReceived=function(){if(this.$6[h.RECV_ANSWER])return!0;else return!1};c.onCallStarted=function(a){this.$4=a,this.$49(h.CALL_STARTED),this.$47()};c.setCallTrigger=function(a){this.$4=a,this.$47()};c.onPopupOpened=function(){this.$50(i.POPUP_OPENED),this.$21++,this.$47()};c.onPressedAnswer=function(){this.$50(i.PRESSED_ANSWER),this.$47()};c.onMediaRequested=function(){this.$50(i.MEDIA_REQUESTED),this.$47()};c.onMediaSucceeded=function(){this.$50(i.MEDIA_SUCCEEDED),this.$47()};c.onFellbackToAudio=function(){this.$50(i.FELLBACK_TO_AUDIO),this.$47()};c.setConnectionType=function(a){this.$37=a,this.$47()};c.setUploadLogLevel=function(a){this.$3=a,this.$47()};c.getCallType=function(){return this.$29};c.setCallType=function(a){this.$29=a,this.addExtraInfo(b("FBRTCLogger").Key.CALL_TYPE,a),this.$47()};c.setVideoDurations=function(a,b){this.$31=a,this.$32=b,this.$47()};c.setScreenDuration=function(a){this.addExtraInfo(b("FBRTCLogger").Key.SCREEN_DURATION,a)};c.setConferenceName=function(a){this.$26=a,this.$47()};c.setTotalVideoFilterDuration=function(a){this.addExtraInfo(b("FBRTCLogger").Key.VIDEO_DURATION_WITH_FILTER,Math.ceil(a).toString())};c.setCoExperienceEffectDuration=function(a){this.addExtraInfo(b("FBRTCLogger").Key.EFFECT_TOTAL_DURATION,Math.ceil(a).toString())};c.setEffectCount=function(a){this.addExtraInfo(b("FBRTCLogger").Key.EFFECT_COUNT,a.toString())};c.setJoinWithSID=function(a){this.$27=a,this.$47()};c.setServerInfoData=function(a){this.$30=a,this.$47()};c.setActiveConnection=function(a){this.$25=a,this.$47()};c.setEscalationP2PCallID=function(a){this.$28=a,this.$47()};c.onOfferAckSent=function(a){this.onMessageSent({type:b("FBRTCConstants").PayloadType.OFFER_ACK,flag:a.flag})};c.onMessageSent=function(a){__p&&__p();var c=a.flag===1;switch(a.type){case b("FBRTCConstants").PayloadType.OFFER:this.$51(c,h.SENT_OFFER,h.SENT_RETRIED_OFFER);this.$52(a,this.$10,this.$12);break;case b("FBRTCConstants").PayloadType.ANSWER:this.$51(c,h.SENT_ANSWER,h.SENT_RETRIED_ANSWER);this.$52(a,this.$10,this.$12);break;case b("FBRTCConstants").PayloadType.OK:this.$49(h.SENT_OK);break;case b("FBRTCConstants").PayloadType.PRANSWER:this.$49(h.SENT_PRANSWER);break;case b("FBRTCConstants").PayloadType.OFFER_ACK:this.$51(c,h.SENT_OFFER_ACK,h.SENT_RETRIED_OFFER_ACK);break;case b("FBRTCConstants").PayloadType.ANSWER_ACK:this.$51(c,h.SENT_ANSWER_ACK,h.SENT_RETRIED_ANSWER_ACK);break;case b("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$52(a,this.$10,this.$12);break;case b("FBRTCConstants").PayloadType.ACK:a.ack_type===b("FBRTCConstants").PayloadType.VIDEO_REQUEST&&this.$53(k.SENT_ESC_REQUEST_ACK);break;case b("FBRTCConstants").PayloadType.VIDEO_REQUEST:a.ack_id?this.$53(k.SENT_ESC_RESPONSE):this.$53(k.SENT_ESC_REQUEST);break;default:}this.$47()};c.$52=function(a,b,c){var d,e=null;a=this.$24.extractIceInfo(a.sdp);for(var f=0;f<a.length;f++)d=a[f].gen,e=a[f].type,d===0&&this.$54(b,e),this.$54(c,e)};c.$54=function(a,b){!a[b]?a[b]=1:a[b]+=1};c.$55=function(a){this.addExtraInfo(b("FBRTCLogger").Key.PEER_IS_MOBILE,a.isFromMobile()?"1":"0")};c.onFullMessageReceived=function(a){__p&&__p();var c=a.msg,d=c.flag===1;switch(c.type){case b("FBRTCConstants").PayloadType.OFFER:this.$55(a);this.$51(d,h.RECV_OFFER,h.RECV_RETRIED_OFFER);this.$52(c,this.$11,this.$13);break;case b("FBRTCConstants").PayloadType.ANSWER:this.$55(a);this.$51(d,h.RECV_ANSWER,h.RECV_RETRIED_ANSWER);this.$52(c,this.$11,this.$13);break;case b("FBRTCConstants").PayloadType.OK:this.$49(h.RECV_OK);break;case b("FBRTCConstants").PayloadType.PRANSWER:this.$49(h.RECV_PRANSWER);break;case b("FBRTCConstants").PayloadType.OFFER_ACK:this.$51(d,h.RECV_OFFER_ACK,h.RECV_RETRIED_OFFER_ACK);break;case b("FBRTCConstants").PayloadType.ANSWER_ACK:this.$51(d,h.RECV_ANSWER_ACK,h.RECV_RETRIED_ANSWER_ACK);break;case b("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$52(c,this.$11,this.$13);break;case b("FBRTCConstants").PayloadType.ACK:c.ack_type===b("FBRTCConstants").PayloadType.VIDEO_REQUEST&&this.$53(k.RECV_ESC_REQUEST_ACK);break;case b("FBRTCConstants").PayloadType.VIDEO_REQUEST:c.ack_id?c.videoon||c.reqVideoOn?this.$53(k.RECV_ESC_ACCEPT):this.$53(k.RECV_ESC_DECLINE):c.videoon||c.reqVideoOn?this.$53(k.RECV_ESC_REQUEST):this.$53(k.RECV_ESC_TIMEOUT);break;default:}this.$47()};c.onMsgAckReceived=function(a,b){a=a.msg.flag===1;b?this.$51(a,h.RECV_OFFER_ACK,h.RECV_RETRIED_OFFER_ACK):this.$51(a,h.RECV_ANSWER_ACK,h.RECV_RETRIED_ANSWER_ACK)};c.onNetworkReady=function(){this.$49(h.NETWORK_READY),this.$47()};c.onCallConnected=function(){this.$49(h.CALL_CONNECTED),this.$47()};c.onCallEnded=function(a,b,c,d){this.$33=c,this.$34=a,this.$35=d,this.$36=b,this.$49(h.CALL_ENDED),this.$47()};c.setOfferSentTime=function(){this.$49(h.SENT_OFFER)};c.setOfferAckReceivedTime=function(){this.$49(h.RECV_OFFER_ACK)};c.setAnswerSentTime=function(){this.$49(h.SENT_ANSWER)};c.setAnswerReceivedTime=function(){this.$49(h.RECV_ANSWER)};c.setJoinRequestSent=function(){this.$49(h.SENT_JOIN_REQUEST),this.$47()};c.setJoinResponseReceived=function(){this.$49(h.RECV_JOIN_RESPONSE),this.$47()};c.setJoinResponseProcessed=function(){this.$49(h.PROC_JOIN_RESPONSE),this.$47()};c.setRingRequestReceived=function(){this.$49(h.RECV_RING_REQUEST),this.$47()};c.setRingResponseSent=function(){this.$49(h.SENT_RING_RESPONSE),this.$47()};c.setEscalationAvailable=function(){this.$56(j.ESCALATION_IS_AVAILABLE)};c.setEscalationInitiated=function(){this.$56(j.USER_INITIATED_REQUEST)};c.setReceivedEscalationRequest=function(){this.$56(j.RECEIVED_INCOMING_REQUEST)};c.setInvalidP2PEscalationState=function(){this.$56(j.REJECTED_INVALID_P2P_STATE)};c.setEscalationConnectingToMultiway=function(){this.$56(j.CONNECTING_TO_MULTIWAY)};c.setEscalationConnectedToMultiway=function(){this.$56(j.CONNECTED_TO_MULTIWAY)};c.setEscalationPeerConnectingToMultiway=function(){this.$56(j.PEER_CONNECTING_TO_MULTIWAY)};c.setEscalationPeerConnectedToMultiway=function(){this.$56(j.PEER_CONNECTED_TO_MULTIWAY)};c.setReadyToEscalate=function(){this.$56(j.READY_TO_ESCALATE)};c.setEscalationPeerFailedToConnectToMultiway=function(){this.$56(j.PEER_FAILED_TO_CONNECT_TO_MULTIWAY)};c.setEscalationTimedOut=function(){this.$56(j.TIMED_OUT)};c.setVidEscalationInitClick=function(){this.$53(k.ESCALATION_INITIATION_BUTTON_CLICKED)};c.setVidEscalationAcceptedClick=function(){this.$53(k.ESCALATION_APPROVED_BUTTON_CLICKED)};c.setVidEscalationDeclinedClick=function(){this.$53(k.ESCALATION_DECLINED_BUTTON_CLICKED)};c.setVidEscalationMediaRequested=function(){this.$53(k.USERMEDIA_REQUEST)};c.setVidEscalationMediaSuccess=function(){this.$53(k.USERMEDIA_SUCCESS)};c.setVidEscalationMediaFailed=function(){this.$53(k.USERMEDIA_FAILURE)};c.setVideoCapabilities=function(a){this.addExtraInfo(b("FBRTCLogger").Key.VIDEO_CAPABILITIES,a)};c.setMediaInputs=function(a){this.addExtraInfo(b("FBRTCLogger").Key.MEDIA_INPUTS,a)};c.getVideoReceivedCodec=function(){return this.$40};c.setVideoReceivedCodec=function(a){this.$40=a};c.getVideoSentCodec=function(){return this.$41};c.setVideoSentCodec=function(a){this.$41=a};c.getAudioSentCodec=function(){return this.$42};c.setAudioSentCodec=function(a){this.$42=a};c.toString=function(){var a={};a.core_metrics=this.$57();a.time_series=null;return JSON.stringify(a)};c.$57=function(){__p&&__p();var a={};a.ver=this.$1;a.log_level=b("FBRTCConstants").uploadLogLevelString(this.$3);a.caller=this.$2;a.call_type=this.$29;a.active_conn=this.$25;a.app_event_times=this.$9;a.conf_name=this.$26;a.join_with_sid=this.$27;a.esc_p2p_call_id=this.$28;a.esc_state_times=this.$8;a.vid_esc_times=this.$14;a.serv_info=this.$30;a.conn=this.$58();a.peer_id=this.peerID;a.has_video=!0;a.open_count=this.$21;a.signaling=this.$59();a.sender=this.$60();a.receiver=this.$61();a.end=this.$62();a.video=this.$63();a.push_phase=b("SiteData").push_phase;a.DebugAudioMetrics=this.$64();a.device_charged=this.$39;a.client_version=this.$5;return a};c.$64=function(){return{NetworkReceive:{jb_nm:this.$65()}}};c.$65=function(){var a=this,b={},c=this.$43.getAudioStreamReportKeys().pop();l.forEach(function(d){var e=a.$43.getMetricStats(c,d);e&&(b[d]={m:e.min,M:e.max,avg:e.mean})});var d=this.$43.getJitterBufferStats(c);b.neteq={maxWait:d.max,meanWait:d.mean||0,mediaWait:d.median||0,minWait:d.min};return b};c.$58=function(){var a={dtls:1},b=this.$60();b.avgrtt&&(a.avgrtt=b.avgrtt,a.maxrtt=b.maxrtt,a.minrtt=b.minrtt);this.$38!==null&&(a.relay_ip=this.$38);return a};c.$59=function(){var a={};this.$4&&(a.trigger=this.$4);a.start_time=this.$15;a.time_from_start=this.$6;a.new_time_from_start=this.$7;var b=this.$66();b>0&&(a.duration=b);return a};c.$66=function(a){var b=this.$7[h.CALL_CONNECTED]||this.$7[h.NETWORK_READY];if(!b)return 0;a=this.$7[h.CALL_ENDED]||!(a==null?void 0:a.assumeOngoing)&&this.$16||this.$48();return Math.max(0,a-b)};c.$60=function(){__p&&__p();var a=this,c={},d=this.$43.getAudioStreamReportKeys();d.some(function(d){d=a.$43.getMetricStats(d,b("FBRTCMediaMetricsConst").AUDIO_BYTES_SENT);if(d!=null){c.bytes=d.current;var e=d.updatedTime-d.startedTime;e>0&&(c.ube_avg=(d.current-d.first)*8/e*1e3);return!0}return!1});d.some(function(d){d=a.$43.getMetricStats(d,b("FBRTCMediaMetricsConst").AUDIO_PACKETS_SENT_LOST);if(d){c.plost=d.current;return!0}return!1});d.some(function(d){d=a.$43.getMetricStats(d,b("FBRTCMediaMetricsConst").AUDIO_PACKETS_SENT);if(d){c.psent=d.current;return!0}return!1});d.some(function(d){d=a.$43.getMetricStats(d,b("FBRTCMediaMetricsConst").AUDIO_RTT_SENT);if(d){c.avgrtt=d.mean;c.maxrtt=d.max;c.minrtt=d.min;return!0}return!1});this.$10&&(c.ice_g0=this.$10);this.$12&&(c.ice=this.$12);this.$42!=null&&this.$42!==""&&(c.codec={www:this.$42});return c};c.$61=function(){__p&&__p();var a=this,c={},d=this.$43.getAudioStreamReportKeys();d.some(function(d){__p&&__p();var e=a.$43.getMetricStats(d,b("FBRTCMediaMetricsConst").DECODING_PLC),f=a.$43.getMetricStats(d,b("FBRTCMediaMetricsConst").DECODING_PLC_CNG),g=a.$43.getMetricStats(d,b("FBRTCMediaMetricsConst").DECODING_CNG);d=a.$43.getMetricStats(d,b("FBRTCMediaMetricsConst").DECODING_NORMAL);if(g!=null&&d!=null&&e!=null&&f!=null){c.dec_cng=g.current;c.dec_normal=d.current;c.dec_plc=e.current;c.dec_plc_cng=f.current;c.neteq_calls=c.dec_cng+c.dec_normal+c.dec_plc+c.dec_plc_cng;return!0}return!1});d.some(function(d){d=a.$43.getMetricStats(d,b("FBRTCMediaMetricsConst").AUDIO_BYTES_RECEIVED);if(d){c.bytes=d.current;var e=d.updatedTime-d.startedTime;e>0&&(c.dbe_avg=(d.current-d.first)*8/e*1e3);return!0}return!1});d.some(function(d){d=a.$43.getMetricStats(d,b("FBRTCMediaMetricsConst").AUDIO_PACKETS_RECEIVED_LOST);if(d){c.plost=d.current;return!0}return!1});d.some(function(d){d=a.$43.getMetricStats(d,b("FBRTCMediaMetricsConst").AUDIO_PACKETS_RECEIVED);if(d){c.precv=d.current;return!0}return!1});d.some(function(d){d=a.$43.getMetricStats(d,b("FBRTCMediaMetricsConst").AUDIO_RTT_RECEIVED);if(d){c.avgrtt=d.mean;c.maxrtt=d.max;c.minrtt=d.min;return!0}return!1});this.$11&&(c.ice_g0=this.$11);this.$13&&(c.ice=this.$13);return c};c.$62=function(){var a={};this.$34!=null&&(a.end_call_reason_string=b("FBRTCConstants").callEndReasonString(this.$34),this.$35!==null&&(a.end_call_subreason_string=this.$35),a.remote_ended=this.$36);this.$37&&(a.conn_type=this.$37);return a};c.$63=function(){var a={ename:this.$41,eqps:this.$67(),frames:this.$68(),psent:null,plost:null};return{sender:this.$69(a),receiver:this.$70(),ld:this.$31,rd:this.$32,bwe:this.$71()}};c.$67=function(){var a=this,c=null,d=this.$43.getVideoStreamReportKeys();d.some(function(d){d=a.$43.getVideoMetric(d,b("FBRTCMediaMetricsConst").OUTBOUND_QP);if(d){c=d.current;return!0}return!1});return c};c.$68=function(){var a=this,c=null,d=this.$43.getVideoStreamReportKeys();d.some(function(d){d=a.$43.getVideoMetric(d,b("FBRTCMediaMetricsConst").FRAMES_ENCODED);if(d){c=d.current;return!0}return!1});return c};c.$71=function(){__p&&__p();var a=this,c={avg_enc_bitrate:this.$72(),avg_send_bw:null,avg_trans_bitrate:null,avg_retrans_bitrate:null},d=this.$43.getVideoStreamReportKeys();d.some(function(d){var e=a.$43.getVideoMetric(d,b("FBRTCMediaMetricsConst").VIDEOBWE_SEND_BANDWIDTH),f=a.$43.getVideoMetric(d,b("FBRTCMediaMetricsConst").VIDEOBWE_TRANSMIT_BITRATE);d=a.$43.getVideoMetric(d,b("FBRTCMediaMetricsConst").VIDEOBWE_RETRANSMIT_BITRATE);if(e&&f&&d){c.avg_send_bw=e.mean;c.avg_trans_bitrate=f.mean;c.avg_retrans_bitrate=d.mean;return!0}return!1});return c};c.$72=function(){__p&&__p();var a=this,c=this.$43.getVideoStreamReportKeys(),d=null;c.some(function(c){c=a.$43.getVideoMetric(c,b("FBRTCMediaMetricsConst").VIDEO_BYTES_SENT);if(c){var e=c.current-c.first;c=c.updatedTime-c.startedTime;c>0&&(d=e*8/c*1e3);return!0}return!1});return d};c.$69=function(a){__p&&__p();var c=this,d=this.$43.getVideoStreamReportKeys();d.some(function(d){var e=c.$43.getVideoMetric(d,b("FBRTCMediaMetricsConst").VIDEO_PKTS_SENT);d=c.$43.getVideoMetric(d,b("FBRTCMediaMetricsConst").VIDEO_PKTS_SEND_LOST);if(e&&d){a.psent=e.current;a.plost=d.current;return!0}return!1});return a};c.$70=function(){__p&&__p();var a=this,c={dec_bytes:null,dec_time:null,dname:this.$40,frd:null,precv:null,plost:null,qps:null},d=this.$43.getVideoStreamReportKeys();d.some(function(d){var e=a.$43.getVideoMetric(d,b("FBRTCMediaMetricsConst").VIDEO_PKTS_RECEIVED);d=a.$43.getVideoMetric(d,b("FBRTCMediaMetricsConst").VIDEO_PKTS_RECV_LOST);if(e&&d){c.precv=e.current;c.plost=d.current;return!0}return!1});d.some(function(d){d=a.$43.getVideoMetric(d,b("FBRTCMediaMetricsConst").VIDEO_BYTES_RECEIVED);if(d){c.dec_bytes=d.current-d.first;c.dec_time=d.updatedTime-d.startedTime;return!0}return!1});d.some(function(d){var e=a.$43.getVideoMetric(d,b("FBRTCMediaMetricsConst").FRAMES_DECODED);d=a.$43.getVideoMetric(d,b("FBRTCMediaMetricsConst").INBOUND_QP);if(e&&d){c.frd=e.current;c.qps=d.current;return!0}return!1});return c};c.$73=function(){return new Date().valueOf()-this.$15};c.$48=function(){var a=b("performanceNow")()-this.$20;return Math.floor(this.$16+a)};c.$49=function(a){if(this.$6[a])return;this.$6[a]=this.$73();this.$7[a]=this.$48()};c.$56=function(a){if(this.$8[a])return;this.$8[a]=this.$73()};c.$50=function(a){if(this.$9[a])return;this.$9[a]=this.$73()};c.$53=function(a){if(this.$14[a])return;this.$14[a]=this.$73()};c.setDeviceCharged=function(a){this.$39=a};c.$51=function(a,b,c){a?this.$49(c):this.$49(b)};c.$47=function(){this.$17=new Date().valueOf()};c.$44=function(){var a=b("UserAgentData").platformName;window.navigator.userAgent.toLowerCase().includes("mobile")&&(a+=" Mobile");return{device:b("UserAgentData").deviceName,os:a,os_version:b("UserAgentData").platformFullVersion,browser:b("UserAgentData").browserName,browser_version:b("UserAgentData").browserFullVersion,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth,user_agent:window.navigator.userAgent}};c.$45=function(){window.navigator.connection!=null&&window.navigator.connection.effectiveType!=null&&this.addExtraInfo(b("FBRTCLogger").Key.CONNECTION_EFFECTIVE_TYPE,window.navigator.connection.effectiveType)};c.$46=function(){navigator.hardwareConcurrency!=null&&this.addExtraInfo(b("FBRTCLogger").Key.CPU_CORES,navigator.hardwareConcurrency),window.navigator.deviceMemory!=null&&this.addExtraInfo(b("FBRTCLogger").Key.DEVICE_MEMORY,window.navigator.deviceMemory),this.addExtraInfo(b("FBRTCLogger").Key.DEVICE_PIXEL_RATIO,window.devicePixelRatio)};c.getCallDuration=function(){var a=b("gkx")("707989");return this.$66({assumeOngoing:a})};c.getConnectedStartTime=function(){return this.$6[h.CALL_CONNECTED]?this.$6[h.CALL_CONNECTED]+this.$15:0};c.getCurrentTimeFromCallConnected=function(){var a=this.$7[h.CALL_CONNECTED];return this.$48()-a};c.getMediaMetricTracker=function(){return this.$43};c.getEndCallReason=function(){return this.$34!=null?b("FBRTCConstants").callEndReasonString(this.$34):"Unknown"};c.setRelayIP=function(a){this.$38=a};return a}();c.CANONICAL_NULL_SUMMARY=Object.freeze(c.nullSummary());c.OLDEST_SUPPORTED_SUMMARY_VERSION=19;c.CURRENT_SUMMARY_VERSION=24;c.CURRENT_CLIENT_VERSION=a();c.REPORT_KEY="reportID";e.exports=c}),null);
__d("FBRTCCallSummaryStore",["CacheStorage","FBLogger","FBRTCCallSummary","FBRTCLogger","areEqual","setTimeout"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="localstorage",h="RTC_CALL_SUMMARY_",i="summary",j=2e3,k=3,l=3*60*1e3,m=null;a=function(){__p&&__p();a.getInstance=function(){m||(m=new a());return m};function a(){this.$1=new(b("CacheStorage"))(g,h),this.$2=b("FBRTCLogger").getInstance()}var c=a.prototype;c.storeCallSummary=function(a,c,d){__p&&__p();if(d.isNull()){b("FBLogger")("rtweb").mustfix("Storing invalid FBRTCCallSummary!");return}var e=this;this.$3(function(b){__p&&__p();b[a]||(b[a]={});var f=b[a][c];if(f){f=e.$4(f);if(f&&f.getLastUpdatedTime()>d.getLastUpdatedTime()){e.$2.logToConsole("Outdated summaries");return null}}b[a][c]=e.$5(d);return b},e.$2.logError.bind(e.$2,a,c))};c.retrieveCallSummary=function(a,b){var c=this.getCallSummaries(),d=null;c[a]&&(d=c[a][b]);if(d)return this.$4(d);else return null};c.removeCallSummary=function(a,b){this.removeCallSummaries([{peerID:a,callID:b}])};c.removeCallSummaries=function(a){var b=this;this.$3(function(c){var d=a.length;for(var e=0;e<d;e++){var f=a[e].peerID,g=a[e].callID;c[f]&&c[f][g]&&(delete c[f][g],b.$6(c[f])&&delete c[f])}return c},this.$2.logError.bind(this.$2,null,null))};c.getLoggableSummaries=function(){var a=this.getCallSummaries(),b=[];for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c))for(var d in a[c])if(Object.prototype.hasOwnProperty.call(a[c],d)){var e=this.$4(a[c][d],l);e&&b.push(e)}return b};c.$6=function(a){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0};c.$5=function(a){a={__t:Date.now(),__d:a.toJsonString()};return a};c.$4=function(a,c){return a&&(!c||Date.now()-a.__t>=c)?b("FBRTCCallSummary").fromJsonString(a.__d):null};c.getCallSummaries=function(){var a=this.$1.get(i)||{};return a};c.$3=function(a,c,d,e){__p&&__p();d===void 0&&(d=k);(d===void 0||d===null)&&(d=k);var f=this.getCallSummaries(),g=this.getCallSummaries();f=a(f);if(f===null)return;var h=this.getCallSummaries();if(b("areEqual")(g,h))this.$1.set(i,f);else if(d>0){c("Retry lock");if(e){var l=this;b("setTimeout")(function(){l.$3(a,c,d-1,!0)},j)}else this.$3(a,c,d-1,!0)}else c("Failed to lock")};return a}();e.exports=a}),null);
__d("FBRTCCallSummaryUploader",["Banzai","FBRTCCallSummary","FBRTCCallSummaryStore"],(function(a,b,c,d,e,f){a={init:function(){var a=b("FBRTCCallSummaryStore").getInstance();b("Banzai").subscribe(b("Banzai").SEND,function(){b("FBRTCCallSummary").logSavedSummaries(a)})}};e.exports=a}),null);
__d("WaterfallMessageLifetimeTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:WaterfallMessageLifetimeLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:WaterfallMessageLifetimeLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:WaterfallMessageLifetimeLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setAttemptID=function(a){this.$1.attempt_id=a;return this};c.setDestService=function(a){this.$1.dest_service=a;return this};c.setDeviceID=function(a){this.$1.device_id=a;return this};c.setEventType=function(a){this.$1.event_type=a;return this};c.setIsBatch=function(a){this.$1.is_batch=a;return this};c.setIsGroup=function(a){this.$1.is_group=a;return this};c.setMessageID=function(a){this.$1.message_id=a;return this};c.setOfflineThreadingID=function(a){this.$1.offline_threading_id=a;return this};c.setPageID=function(a){this.$1.page_id=a;return this};c.setPushNotifID=function(a){this.$1.push_notif_id=a;return this};c.setReceiptID=function(a){this.$1.receipt_id=a;return this};c.setSenderID=function(a){this.$1.sender_id=a;return this};c.setServiceName=function(a){this.$1.service_name=a;return this};c.setSrcService=function(a){this.$1.src_service=a;return this};c.setThreadID=function(a){this.$1.thread_id=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setTimeStamp=function(a){this.$1.time_stamp=a;return this};c.setTopic=function(a){this.$1.topic=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};c.updateExtraData=function(a){a=b("nullthrows")(b("GeneratedLoggerUtils").serializeMap(a));b("GeneratedLoggerUtils").checkExtraDataFieldNames(a,g);this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};return a}();var g={attempt_id:!0,dest_service:!0,device_id:!0,event_type:!0,is_batch:!0,is_group:!0,message_id:!0,offline_threading_id:!0,page_id:!0,push_notif_id:!0,receipt_id:!0,sender_id:!0,service_name:!0,src_service:!0,thread_id:!0,time:!0,time_stamp:!0,topic:!0,weight:!0};e.exports=a}),null);
__d("FantaTabMainPlaceholder.react",["cx","ChatConfig","React","XUISpinner.react","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return b("React").createElement("div",{className:"_59v1"},b("React").createElement("div",{className:"_5qi9 _5qib"},b("React").createElement("div",{className:"_3_9e _s0f _50mz _50m_ fbNub _50-v opened _27_3"},b("React").createElement("div",{className:"fbNubFlyout fbDockChatTabFlyout uiContextualLayerParent _6vu1"},b("React").createElement("div",{className:"fbNubFlyoutOuter"},b("React").createElement("div",{className:"fbNubFlyoutInner _6vu1"+(b("gkx")("697231")?" _6z9d":"")},b("React").createElement("div",{className:"_5-kq"},b("React").createElement(b("XUISpinner.react"),null))))))))};e.exports=a}),null);
__d("FantaTabsEagerBootloader",["Bootloader","emptyFunction","ifRequired"],(function(a,b,c,d,e,f){"use strict";var g=function(a){b("ifRequired")("FantaAppStore",function(b){return b.addReducers(a)}),g=b("emptyFunction")};a={bootload:function(){b("ifRequired")("FantaTabsSlimApp",function(a){a.silentPumpUp()}),b("Bootloader").loadModules(["FantaReducersGetMessages","FantaTabsReactApp","MessengerGraphQLThreadFetcher.bs"],function(a){g(a)},"FantaTabsEagerBootloader")}};e.exports=a}),null);
__d("P2PActionConstants",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({CREDIT_CARDS_UPDATED:"credit_cards_updated",CREDIT_CARDS_UPDATED_ERROR:"credit_cards_updated_error",CHANNEL_EVENTS_ALLOWED:"channel_events_allowed",CHANNEL_EVENTS_IGNORED:"channel_events_ignored",CREDIT_CARD_SAVING:"credit_card_saving",CREDIT_CARD_ADDED:"credit_card_added",CREDIT_CARD_ADDED_ERROR:"credit_card_added_error",CREDIT_CARD_ADDED_ERROR_CLEARED:"credit_card_added_error_cleared",CREDIT_CARD_DELETED:"credit_card_deleted",CREDIT_CARD_DELETED_ERROR:"credit_card_deleted_error",CREDIT_CARD_UPDATED:"credit_card_updated",CREDIT_CARD_UPDATED_ERROR:"credit_card_updated_error",PRESET_CREDIT_CARD_UPDATED:"preset_credit_card_updated",PRESET_CREDIT_CARD_UPDATED_ERROR:"preset_credit_card_updated_error",CREDIT_CARD_VERIFIED:"credit_card_verified",CREDIT_CARD_VERIFIED_ERROR:"credit_card_verified_error",PAYMENT_METHODS_UPDATED:"payment_methods_updated",PAYMENT_METHODS_UPDATED_ERROR:"payment_methods_updated_error",TRANSFERS_UPDATED:"transfers_updated",TRANSFERS_UPDATED_ERROR:"transfers_updated_error",NUX_TRANSFERS_UPDATED:"nux_transfers_updated",TRANSFER_ADDED:"transfer_added",TRANSFER_ADDED_ERROR:"transfer_added_error",TRANSFER_UPDATED:"transfer_updated",TRANSFER_UPDATED_ERROR:"transfer_updated_error",TRANSFER_ACCEPTED:"transfer_accepted",TRANSFER_DECLINED:"transfer_declined",CHAT_SEND_VIEW_OPENED:"chat_send_view_opened",CHAT_SEND_VIEW_CLOSED:"chat_send_view_closed",BIN_NUMBER_VALIDATED:"bin_number_validated",BIN_NUMBER_VALIDATED_ERROR:"bin_number_validated_error",USER_ELIGIBILITY_UDPATED:"user_eligibility_updated",FRIENDS_LIST_UPDATED:"friends_list_updated",DIALOG_SHOWN:"dialog_shown",DIALOG_CLOSED:"dialog_closed",BANNER_STATES_UPDATED:"banner_states_updated",BANNER_DISMISSED:"banner_dismissed",BANNER_VIEWED:"banner_viewed",BANNER_COMPLETED:"banner_completed",PLATFORM_CONTEXT_ADDED:"platform_context_added",PLATFORM_CONTEXT_BANNER_DISMISSED:"platform_context_banner_dismissed",PLATFORM_CONTEXT_PRODUCT_ITEM_SOLD:"platform_context_product_item_sold",PLATFORM_CONTEXT_CHANGED:"platform_context_changed",EXTENSIVE_TRANSFER_DETAILS_UPDATED:"extensive_transfer_details_updated",PAYMENT_REQUEST_INITIATED:"payment_request_initiated",PAYMENT_REQUEST_INITIATED_COMPLETE:"payment_request_initiated_completed",PAYMENT_REQUEST_CREATED:"payment_request_created",PAYMENT_REQUEST_CREATED_ERROR:"payment_request_created_error",PAYMENT_REQUEST_UPDATED:"payment_request_updated",PAYMENT_REQUEST_DECLINE_INITIATED:"payment_request_decline_initiated",PAYMENT_REQUEST_DECLINED:"payment_request_declined",PAYMENT_REQUEST_DECLINE_ERROR:"payment_request_decline_error",PAYMENT_REQUESTS_FETCHED:"payment_requests_fetched",PAYMENT_REQUEST_CANCEL_INITIATED:"payment_request_cancel_initiated",PAYMENT_REQUEST_CANCELED:"payment_request_canceled",PAYMENT_REQUEST_CANCEL_ERROR:"payment_request_cancel_error"});e.exports=a}),null);
__d("P2PDispatcher",["ExplicitRegistrationReactDispatcher"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){b=a.call(this,b)||this;babelHelpers.assertThisInitialized(b).dispatch=b.dispatch.bind(babelHelpers.assertThisInitialized(b));return b}return b}(b("ExplicitRegistrationReactDispatcher"));e.exports=new a({strict:!1})}),null);
__d("FantaTabsSlimApp",["BootloadOnRender.react","ChatPerfInstrumentation","FantaTabMainPlaceholder.react","FantaTabsAppBase","JSResource","LazyComponent.react","React","ReactDOM","UserActivity","emptyFunction","gkx","ifRequired","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=500;a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){__p&&__p();var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$FantaTabsSlimApp1=!1,d.$FantaTabsSlimApp3=function(a,c){d.$FantaTabsSlimApp1?b("ifRequired")("FantaMessageActions",function(d){b("setImmediate")(function(){d.receivedNewMessage(a,c)})}):d.$FantaTabsSlimApp2(function(){b("ifRequired")("FantaMessageActions",function(d){b("setImmediate")(function(){d.receivedNewMessage(a,c)})})})},c)||babelHelpers.assertThisInitialized(d)}var e=c.prototype;e.getPumpedUp=function(a){this.$FantaTabsSlimApp1?a():this.$FantaTabsSlimApp2(a)};e.silentPumpUp=function(){this.$FantaTabsSlimApp1||this.$FantaTabsSlimApp2(b("emptyFunction"),!0)};e.getViewComponent=function(a){a=a?b("React").createElement("div",null):b("React").createElement(b("FantaTabMainPlaceholder.react"),null);return b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{loadDataOnMount:!1}),loader:b("JSResource")("FantaMercuryTabsWithMain.react").__setRef("FantaTabsSlimApp"),placeholder:a})};e.initializeFantaData=function(a){__p&&__p();var c=this;d(["FantaCookieUtil","MercuryThreadInformer","PresenceState"],function(d,e,f){__p&&__p();f.registerStateLoader(function(e){if(c.$FantaTabsSlimApp1)b("ifRequired")("FantaTabActions",function(c){b("ifRequired")("FantaAppStore",function(b){c.loadFromData(d.convertCookieData(e,b.getState().tabGroup,a))})});else{var f=d.convertCookieData(e,null,a);f&&f.tabs.length>0&&c.$FantaTabsSlimApp2(function(){b("ifRequired")("FantaTabActions",function(a){a.loadFromData(f)})})}}),f.doSync(),e.get().subscribe("threads-updated",function(a,c){b("ifRequired")("FantaGetMessageActions",function(a){Object.keys(c).forEach(function(c){b("setImmediate")(function(){a.refreshThread(c)})})})}),b("ChatPerfInstrumentation").logInitData()})};e.$FantaTabsSlimApp2=function(a,c){__p&&__p();var e=this;b("ifRequired")("FantaAppStore",function(b){a()},function(){__p&&__p();d(["FantaAppStore","FantaCookieUtil","FantaMessageActions","FantaTabActions","FantaTabViewportManager","PresenceState"],function(d,f,i,j,k,l){l.registerStateStorer(function(a){if(!b("UserActivity").isOnTab()&&!b("UserActivity").isActive(h)&&!b("gkx")("678595"))return a;var c=d.getState().tabGroup;if(!g||g&&!g.equals(c)){g=c;return f.createCookieData(c,a)}else return a}),b("ReactDOM").render(e.getViewComponent(c),e.tabsElem),k.init(e.tabsElem),e.$FantaTabsSlimApp1=!0,a()})})};e.initializeFantaUI=function(){var a=this;d(["FantaMercuryThreadEventsBootloaded","FantaMessageActions","FantaTabActions","FantaTabViewportManager","FBRTCMessageHandler","MercuryBrowserAlerts"],function(c,d,e,f,g,h){g.init(),h.init(),c.registerForNewLogMessage(a.$FantaTabsSlimApp3),c.registerForNewMessage(a.$FantaTabsSlimApp3),b("ChatPerfInstrumentation").logInitUI(),b("ChatPerfInstrumentation").logDisplayDone()})};return c}(b("FantaTabsAppBase"));e.exports=new a()}),null);
__d("MercuryRealTimeEnvironmentDropDown",["Arbiter","Bootloader","FBLogger","MessengerMQTTGating"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={token:null,init:function(){g.token=b("Arbiter").subscribe("mqtt-websocket-connection-died",g.handleConnectionDied)},handleConnectionDied:function(){if(!g.token||!b("MessengerMQTTGating").isEnabled())return;g.token&&(b("Arbiter").unsubscribe(g.token),g.token=null);g.dropDownToChannel()},dropDownToChannel:function(){b("MessengerMQTTGating").turnOff(),b("Bootloader").loadModules(["ChannelManager"],function(a){a.startChannelManager(),b("Arbiter").inform("messenger-mqtt-drop-down-to-channel")},"MercuryRealTimeEnvironmentDropDown"),b("FBLogger")("messenger_web_mqtt").warn("drop down to channel")}};e.exports=g}),null);
__d("MercurySyncResnapshot",["Promise","Bootloader","MercurySingletonProvider"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(a){this.$2=a}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};var c=a.prototype;c.resnapshot=function(){var a=this;this.$1||(this.$1=new(b("Promise"))(function(c,d){b("Bootloader").loadModules(["MercurySyncDeltaHandler"],function(b){b.getForFBID(a.$2).emergencyDFF(function(b){c(b),a.$1=null},function(){d(),a.$1=null})},"MercurySyncResnapshot")}));return this.$1};return a}();var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("IrisSubscribeChecker",["MqttLogger","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1=b("MqttLogger").getInstance(),this.$2=null,this.$3=!1,this.$4=!1,this.$5=!1,this.$6=!0}var c=a.prototype;c.start=function(){this.$6=!0};c.stop=function(){this.$6=!1,this.$7()};c.onConnectAttempt=function(){};c.onConnectFailure=function(){};c.onConnected=function(){var a=this;this.$7();this.$3=!1;this.$4=!1;this.$5=!1;this.$6&&(this.$2=b("setTimeoutAcrossTransitions")(function(){a.$8()},8e3))};c.onConnectSuccess=function(){};c.onConnectionLost=function(){this.$7()};c.onSubscribe=function(a){a==="/t_ms"&&(this.$3=!0)};c.onUnsubscribe=function(a){};c.onPublish=function(a){(a==="/messenger_sync_get_diffs"||a==="/messenger_sync_create_queue")&&(this.$4=!0,this.$3&&(this.$5=!0,this.$7()))};c.onMessage=function(a){};c.onWSFatal=function(){};c.$7=function(){this.$2!==null&&(b("clearTimeout")(this.$2),this.$2=null)};c.$8=function(){this.$3===!1&&(this.$1.bumpCounter("no_iris_topic_subscribe"),this.$1.debugTrace("irisSubscribeChecker","iris topic not subscribed")),this.$4===!1&&(this.$1.bumpCounter("no_iris_session"),this.$1.debugTrace("irisSubscribeChecker","iris session not subscribed")),this.$3===!0&&this.$4===!0&&this.$5===!1&&(this.$1.bumpCounter("session_before_topic_subscribe"),this.$1.debugTrace("irisSubscribeChecker","iris session subscribed before topic subscribe"))};return a}();e.exports=a}),null);
__d("MqttWaterfallLogger",["WaterfallMessageLifetimeTypedLogger","gkx"],(function(a,b,c,d,e,f){"use strict";a={logNewMessageToWaterfall:function(a){var c=a.senderID,d=a.receiptID,e=a.messageID,f=a.offlineThreadingID,g=a.threadID,h=a.irisSeqId;a=a.isGroup;if(!b("gkx")("832242"))return;new(b("WaterfallMessageLifetimeTypedLogger"))().setEventType("message_receive_ws").setSrcService("mqtt").setDestService("webclient").setSenderID(c).setReceiptID(d).setMessageID(e).setOfflineThreadingID(f).setThreadID(g).setIsGroup(a?1:0).addToExtraData("sync_seq_id",h).log()}};e.exports=a}),null);
__d("MessageEventStream",["Int64","IrisSubscribeChecker","MercurySingletonProvider","MqttLogger","MqttWaterfallLogger","exponentialBackoff","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();a.getForFBID=function(a){return g.getForFBID(a)};function a(a){__p&&__p();var c=this;this.$12=function(){__p&&__p();var a;if(c.$4){if(!c.$3){c.$5.bumpCounter("subscribe_to_iris_no_seq_id");return}a=c.$17()}else a=c.$18();c.$5.debugTrace("Sending request",JSON.stringify({topic:a.topic,payload:a.payload}));c.$9.publish(a.topic,a.payload,{qos:1,skipBuffer:!0})};this.$1=a;this.$2=[];this.$5=b("MqttLogger").getInstance();this.$11=new(b("exponentialBackoff"))(this.$12,this);this.$10=new(b("IrisSubscribeChecker"))()}var c=a.prototype;c.getPublishMessages=function(){return this.$13()};c.init=function(a,c,d,e){__p&&__p();var f=this;if(!c&&!e)return this;this.$9=a;this.$9.addHook(this.$10);this.$8=!0;this.$3=c?b("Int64").fromString(c):null;this.$6=d;this.$7=e;this.$4=null;this.$9.subscribe("/t_ms",function(a){return f.$14(a)});this.$9.subscribe("/thread_typing",function(a){f.$15(a)});this.$9.subscribe("/orca_typing_notifications",function(a){f.$15(a)});this.$9.subscribe("/notify_disconnect",function(a){return f.$16(a)});this.connectToIris();return this};c.connectToIris=function(a){a===void 0&&(a=null),a!==null&&(this.$3=b("Int64").fromString(a)),this.$8=!0,this.$10.start(),this.$9.registerExtraConnectPayloadProvider(this)};c.$13=function(){__p&&__p();var a;if(this.$4){if(!this.$3){this.$5.bumpCounter("connect_payload_iris_no_seq_id");return[]}a=this.$17()}else a=this.$18();this.$5.debugTrace("Sending request with MQTT Connect",JSON.stringify({topic:a.topic,payload:a.payload}));return[a]};c.$19=function(a){var b=null;try{b=JSON.parse(a)}catch(a){this.$5.logError(a,"Unable to process data")}return b};c.$15=function(a){var b=this.$19(a);if(b==null){this.$5.logWarn("_processTypingData","Unable to process typing data");return}this.$2.forEach(function(a){typeof a.onTypingReceived==="function"&&a.onTypingReceived(b)})};c.addDeltaStreamListener=function(a){this.$2.push(a)};c.$16=function(a){this.$5.logWarn("_handleNotifyDisconnect","Disconnecting reason: "+a),this.$5.bumpCounter("notify_disconnect_"+a),a==="IRIS_CURSOR_LIMIT"&&this.$20(a)};c.$20=function(a){this.$5.bumpCounter(a+"_request"),this.$4=null,this.$8=!1,this.$10.stop(),this.$9.unregisterExtraConnectPayloadProvider(this),this.$2.forEach(function(b){return b.onStreamDisconnect(a)})};c.$14=function(a){__p&&__p();a=this.$19(a);if(a==null){this.$5.logWarn("_processDeltas","Unable to process delta");return}var b={syncToken:a.syncToken,entityId:a.queueEntityId,errorCode:a.errorCode,firstSeqId:a.firstDeltaSeqId,lastSeqId:a.lastIssuedSeqId};this.$5.debugTrace("Sync data received",JSON.stringify(b));b=this.$1;if(a.syncToken){this.$21(a);return}else if(a.queueEntityId!=b){this.$5.bumpCounter("delta_for_other_fbid");return}else a.errorCode?this.$22(a.errorCode):this.$23(a)};c.$22=function(a){this.$5.bumpCounter("iris_queue_error."+a),this.$5.logWarn("_handleIrisError","Recevied an error code from sync protocol "+a),a==="ERROR_QUEUE_TEMPORARY_NOT_AVAILABLE"?this.$11():this.$20(a)};c.$21=function(a){var c=this;this.$4=a.syncToken;this.$3=b("Int64").fromString(a.firstDeltaSeqId.toString());this.$5.debugTrace("Sync token received",JSON.stringify({token:this.$4}));this.$9.subscribeChannelEvents({onMQTTStateChanged:function(a,b){a==="Connected"&&c.$11.reset()}})};c.$23=function(a){var c=a.deltas,d=this.$3;if(c&&d){var e=b("Int64").fromString(a.firstDeltaSeqId.toString());a=b("Int64").fromString(a.lastIssuedSeqId.toString());e.equals(d.add(b("Int64").ONE))?this.$24(e,a,c):e.compare(d)<0?(this.$5.bumpCounter("delta_batch_in_middle"),a.compare(d)>0&&this.$24(d.add(b("Int64").ONE),a,c)):(this.$5.bumpCounter("missing_deltas_get_diffs"),this.$12())}else this.$5.bumpCounter("process_deltas_invalid_state")};c.$24=function(a,c,d){__p&&__p();a=a;for(var e=0;e<d.length;e++){var f=d[e],g=f["class"]||"Missing";try{g=="NewMessage"&&b("MqttWaterfallLogger").logNewMessageToWaterfall({senderID:f.messageMetadata.actorFbId,receiptID:this.$1,messageID:f.messageMetadata.messageId,offlineThreadingID:f.messageMetadata.offlineThreadingId,threadID:f.messageMetadata.threadKey.threadFbId!=null?f.messageMetadata.threadKey.threadFbId:"",irisSeqId:f.irisSeqId?f.irisSeqId:a.toString(),isGroup:f.messageMetadata.threadKey.threadFbId!=null})}catch(a){this.$5.logError(a,"Unable to log to waterfall")}var h={seqId:a.toString(),type:g,status:""},i=1;if(g!="Missing")try{i=this.$25(f,g,a,h)}catch(a){h.status="err:"+a.message}else h.status="no type",this.$5.bumpCounter("missing_delta_type");this.$5.debugTrace("onDeltaReceived",JSON.stringify(h));a=a.add(b("Int64").fromInt(i))}this.$3=c};c.$25=function(a,c,d,e){__p&&__p();var f=1,g="";c==="NoOp"&&(f=a.numNoOps||f,g+="n:"+f);a.irisSeqId||(a.irisSeqId=d.toString(),g+="missing seq id");var h=b("Int64").fromString(a.irisSeqId.toString())||d;h.equals(d)?g+=" seqId match":(g+=" seqId mismatch",this.$5.bumpCounter("seq_id_running_id_mismatch"));var i={type:c,payload:a};this.$2.forEach(function(a){return a.onDeltaReceived(i)});e.status=g;return f};c.$18=function(){var a={sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$1,initial_titan_sequence_id:this.$3&&this.$3.toString(),device_params:this.$6,queue_position:this.$7};return{topic:"/messenger_sync_create_queue",payload:JSON.stringify(a),qos:1}};c.$17=function(){var a={sync_token:this.$4,sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$1,last_seq_id:this.$3&&this.$3.toString()};return{topic:"/messenger_sync_get_diffs",payload:JSON.stringify(a),qos:1}};return a}();var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MessengerMQTTPayloadPreprocessor",[],(function(a,b,c,d,e,f){"use strict";a={process:function(a,b,c){var d=parseInt(c.irisSeqId.toString(),10);return{seqID:d,obj:{queue:a,iseq:d,delta:c,seqID:d,type:b}}}};e.exports=a}),null);
__d("MessengerMQTTPresence",["FBMqttChannel","PresenceStatus"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="/orca_presence",h="/send_additional_contacts",i=!1;a={subscribe:function(){if(i)return;i=!0;b("FBMqttChannel").subscribe(g,function(a){a=JSON.parse(a);a&&a.list&&b("PresenceStatus").setMultiFromMQTT(a.list)})},unsubscribe:function(){i=!1,b("FBMqttChannel").unsubscribe(g)},sendAdditionalBuddyRequest:function(a){b("FBMqttChannel").publish(h,JSON.stringify({additional_contacts:[a]}))}};e.exports=a}),null);
__d("MessengerMQTTPresenceActivity",["Event","MercuryConfig","MessengerMQTTPresence","UserActivity"],(function(a,b,c,d,e,f){__p&&__p();var g=b("MercuryConfig").idle_limit||18e5;a=b("MercuryConfig").idle_poll_interval||3e5;var h=Date.now(),i=!0;function j(){h=Date.now(),b("MessengerMQTTPresence").subscribe()}c={init:function(){b("Event").listen(window,"focus",function(){i=!0,j()}),b("Event").listen(window,"blur",function(){i=!1}),b("UserActivity").subscribe(function(){j()})}};window.setInterval(function(){!i&&Date.now()-h>g&&b("MessengerMQTTPresence").unsubscribe()},a);e.exports=c}),null);
__d("MessengerMQTTTypingDataPreProcessor",[],(function(a,b,c,d,e,f){"use strict";a={process:function(a,b){var c=b.thread;a=c==null?{from:b.sender_fbid,st:b.state,to:a,type:"typ"}:{from:b.sender_fbid,st:b.state,thread:c,thread_fbid:c,type:"ttyp"};return{obj:a}}};e.exports=a}),null);
__d("MessengerMQTTConnection",["Arbiter","CurrentUser","FBMqttChannel","MercuryRealTimeEnvironmentDropDown","MercurySingletonProvider","MercurySyncResnapshot","MessageEventStream","MessengerMQTTConnectionEvents","MessengerMQTTPayloadPreprocessor","MessengerMQTTPresence","MessengerMQTTTypingDataPreProcessor","MqttLogger","gkx","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MessengerMQTTConnectionEvents").DELTA_EVENT,h=b("MessengerMQTTConnectionEvents").STREAM_CONNECT,i=b("MessengerMQTTConnectionEvents").STREAM_DISCONNECT,j=b("MessengerMQTTConnectionEvents").STREAM_CONNECTING;b("MessengerMQTTConnectionEvents").STATE_CONNECTED;var k=b("MessengerMQTTConnectionEvents").STATE_CONNECTING,l=b("MessengerMQTTConnectionEvents").STATE_DISCONNECTED,m=b("MessengerMQTTConnectionEvents").TYP;a=function(){__p&&__p();a.getForFBID=function(a){return n.getForFBID(a)};a.get=function(){return n.get()};function a(a){this.$1=a,this.$2=b("MqttLogger").getInstance()}a.setUp=function(c){__p&&__p();var e=c.fbid,f=c.irisSeqID;c.appID;c.endpoint;b("MercuryRealTimeEnvironmentDropDown").init();if(!e||!f)return;c=b("MqttLogger").getInstance();if(!b("CurrentUser").isLoggedInNow()){c.debugTrace("run","User not logged in");c.bumpCounter("user_not_loggged_in");return}var g=a.getForFBID(e);a.addDeltaStream({fbid:e,irisSeqID:f});g.$3(b("FBMqttChannel").getConnectionState(),b("FBMqttChannel").getLongPollingStatus());b("FBMqttChannel").subscribeChannelEvents({onMQTTStateChanged:function(a,b){g.$3(a,b)},onJSError:function(a){g.$4("mqtt_js_error")}});(b("gkx")("845715")||b("gkx")("845716"))&&b("MessengerMQTTPresence").subscribe();b("gkx")("845716")&&d(["MessengerMQTTPresenceActivity"],function(a){a.init()})};a.addDeltaStream=function(c){var d=c.fbid;c=c.irisSeqID;var e=a.getForFBID(d),f=null;b("gkx")("687751")&&(f={accept_pending_deltas:!0});b("MessageEventStream").getForFBID(d).init(b("FBMqttChannel"),c,f).addDeltaStreamListener(e)};var c=a.prototype;c.onDeltaReceived=function(a){var c=a.type;a=a.payload;c=b("MessengerMQTTPayloadPreprocessor").process(this.$1,c,a);b("Arbiter").inform(g,c)};c.onStreamDisconnect=function(a){__p&&__p();var c=this;if(a==="IRIS_CURSOR_LIMIT"){b("gkx")("678680")&&this.$2.bumpCounter("dropping_down_to_chatproxy.employee_iris_cursor_limit");this.$4("iris_cursor_limit");return}if(a==="ERROR_QUEUE_LOST"||a==="QUEUE_NOT_FOUND"||a==="ERROR_QUEUE_EXCEEDS_MAX_DELTAS"||a==="ERROR_QUEUE_UNDERFLOW"||a==="ERROR_QUEUE_OVERFLOW"){b("promiseDone")(b("MercurySyncResnapshot").getForFBID(this.$1).resnapshot(),function(a){b("MessageEventStream").getForFBID(c.$1).connectToIris(a.toString())},function(){c.$4("resnapshot_failed")});return}b("Arbiter").inform(i,a)};c.onTypingReceived=function(a){a=b("MessengerMQTTTypingDataPreProcessor").process(this.$1,a);b("Arbiter").inform(m,a)};c.$3=function(a,c){if(a=="Connected"||c=="LPActive"){b("Arbiter").inform(h);return}switch(a){case k:b("Arbiter").inform(j);break;case l:b("Arbiter").inform(i);break}};c.$4=function(a){b("Arbiter").inform("mqtt-websocket-connection-died"),this.$2.bumpCounter("dropping_down_to_chatproxy."+a),this.$2.logWarn("connection_died","Dropping down to ChatProxy")};return a}();var n=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MNCommerceActionTypes",["keyMirrorRecursive"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirrorRecursive")({RECEIPT:{LOADED:null,LOAD_ERROR:null,RELOAD:null},SHIPMENT:{LOADED:null,LOAD_ERROR:null,RELOAD:null},DIALOG:{SHOW:null,HIDE:null},RETAIL_ITEM:{LOADED:null,LOAD_ERROR:null,RELOAD:null},PROMOTION_STATE:{LOADED:null,LOAD_ERROR:null,RELOAD:null},TRANSACTION_INVOICE:{LOADED:null,LOAD_ERROR:null,RELOAD:null},BOT_REVIEW_STATE:{LOADED:null,LOAD_ERROR:null,RELOAD:null}});e.exports=a}),null);
__d("MNCommerceDialogStateStore",["FluxStore","MessengerDispatcher","MNCommerceActionTypes"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this,b("MessengerDispatcher"))||this;c.$MNCommerceDialogStateStore1=null;c.$MNCommerceDialogStateStore2=null;return c}var d=c.prototype;d.__onDispatch=function(a){__p&&__p();var c=a.type;switch(c){case b("MNCommerceActionTypes").DIALOG.SHOW:this.$MNCommerceDialogStateStore1=a.dialogContainer;this.$MNCommerceDialogStateStore2=a.state;this.__emitChange();break;case b("MNCommerceActionTypes").DIALOG.HIDE:this.$MNCommerceDialogStateStore1=null;this.$MNCommerceDialogStateStore2=null;this.__emitChange();break}};d.getDialogContainer=function(){return this.$MNCommerceDialogStateStore1};d.getState=function(){return this.$MNCommerceDialogStateStore2};return c}(b("FluxStore"));a.__moduleID=e.id;e.exports=new a()}),null);
__d("MNCommerceDialogContainer.react",["MNCommerceDialogStateStore","PureStoreBasedStateMixin","React"],(function(a,b,c,d,e,f){"use strict";a=b("React").createClass({displayName:"MNCommerceDialogContainer",mixins:[b("PureStoreBasedStateMixin")(b("MNCommerceDialogStateStore"))],statics:{calculateState:function(){var a=b("MNCommerceDialogStateStore").getDialogContainer();return{dialogContainer:a}}},render:function(){var a=this.state.dialogContainer;return!a?null:b("React").createElement(a,null)}});e.exports=a}),null);
__d("MNCommerceDialogContainerMount",["MNCommerceDialogContainer.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";a={mount:function(a){b("ReactDOM").render(b("React").createElement(b("MNCommerceDialogContainer.react"),null),a)}};e.exports=a}),null);
__d("P2PDialogStore",["EventEmitter","P2PActionConstants","P2PDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={};a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this)||this;b("P2PDispatcher").register(c.onEventDispatched.bind(babelHelpers.assertThisInitialized(c)));g={dialogClass:null,dialogProps:null};return c}var d=c.prototype;d.getState=function(){return g};d.onEventDispatched=function(a){__p&&__p();var c=a.type;a=a.data;switch(c){case b("P2PActionConstants").DIALOG_SHOWN:g.dialogClass=a.dialogClass;g.dialogProps=a.dialogProps;this.emit("change");break;case b("P2PActionConstants").DIALOG_CLOSED:g.dialogClass=null;g.dialogProps=null;this.emit("change");break}};return c}(b("EventEmitter"));e.exports=new a()}),null);
__d("P2PDialogContainer.react",["P2PDialogStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.state=b("P2PDialogStore").getState(),d.onDialogStoreChange=function(){d.setState(b("P2PDialogStore").getState())},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentDidMount=function(){this.dialogStoreSub=b("P2PDialogStore").addListener("change",this.onDialogStoreChange)};d.componentWillUnmount=function(){this.dialogStoreSub&&(this.dialogStoreSub.remove(),this.dialogStoreSub=null)};d.render=function(){if(!this.state.dialogClass)return null;var a=this.state.dialogClass;return b("React").createElement(a,babelHelpers["extends"]({},this.state.dialogProps,{key:"dialog"}))};return c}(b("React").Component);e.exports=a}),null);
__d("P2PDialogContainerMount",["P2PDialogContainer.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";a={mount:function(a){b("ReactDOM").render(b("React").createElement(b("P2PDialogContainer.react"),null),a)}};e.exports=a}),null);
__d("PagesPlatformActionConstants",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({BOOKING_REQUEST_ACCEPT_ERROR:"booking_request_accept_error",BOOKING_REQUEST_ACCEPT_INITIATED:"booking_request_accept_initiated",BOOKING_REQUEST_ACCEPTED:"booking_request_accepted",BOOKING_REQUEST_CREATED:"booking_request_created",BOOKING_REQUEST_DECLINE_ERROR:"booking_request_decline_error",BOOKING_REQUEST_DECLINE_INITIATED:"booking_request_decline_initiated",BOOKING_REQUEST_DECLINED:"booking_request_declined",BOOKING_REQUEST_RESCHEDULE_INITIATED:"booking_request_reschedule_initiated",BOOKING_REQUEST_RESCHEULED:"booking_request_reschedule",DIALOG_CLOSED:"dialog_closed",DIALOG_SHOWN:"dialog_shown",NEW_TIME_CHOSEN:"new_time_chosen"});e.exports=a}),null);
__d("PagesPlatformRequestDispatcher",["Dispatcher_DEPRECATED"],(function(a,b,c,d,e,f){"use strict";e.exports=new(b("Dispatcher_DEPRECATED"))()}),null);
__d("PagesPlatformDialogStore",["EventEmitter","PagesPlatformActionConstants","PagesPlatformRequestDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={};a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this)||this;b("PagesPlatformRequestDispatcher").register(c.onEventDispatched.bind(babelHelpers.assertThisInitialized(c)));g={dialogClass:null,dialogProps:null};return c}var d=c.prototype;d.getState=function(){return g};d.onEventDispatched=function(a){__p&&__p();var c=a.type;a=a.data;switch(c){case b("PagesPlatformActionConstants").DIALOG_SHOWN:g.dialogClass=a.dialogClass;g.dialogProps=a.dialogProps;this.emit("change");break;case b("PagesPlatformActionConstants").DIALOG_CLOSED:g.dialogClass=null;g.dialogProps=null;this.emit("change");break}};return c}(b("EventEmitter"));e.exports=new a()}),null);
__d("PagesPlatformDialogContainer.react",["PagesPlatformDialogStore","PureStoreBasedStateMixin","React"],(function(a,b,c,d,e,f){"use strict";a=b("React").createClass({displayName:"PagesPlatformDialogContainer",mixins:[b("PureStoreBasedStateMixin")(b("PagesPlatformDialogStore"))],statics:{calculateState:function(){return b("PagesPlatformDialogStore").getState()}},render:function(){if(!this.state.dialogClass)return null;var a=this.state.dialogClass;return b("React").createElement(a,babelHelpers["extends"]({},this.state.dialogProps,{key:"dialog"}))}});e.exports=a}),null);
__d("PagesPlatformDialogContainerMount",["PagesPlatformDialogContainer.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";a={mount:function(a){b("ReactDOM").render(b("React").createElement(b("PagesPlatformDialogContainer.react"),null),a)}};e.exports=a}),null);
__d("ResponsiveSidebar",["AjaxPipeRequest","Arbiter","Bootloader","ChatConfig","ChatSidebarVisibility","CSS","Event","Run","URI","getOrCreateDOMID","setImmediate","throttle"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("ChatConfig").get("sidebar.hide_divebar_off_homepage"),h=b("ChatConfig").get("sidebar.hide_buddylist_off_homepage"),i="buddylistOff",j=!0;a={init:function(a){__p&&__p();var c=this;if(this.shouldLoadContent(a))b("setImmediate")(function(){c.loadContentForConfig(a)});else{var d=document.documentElement||"";g&&!this.isOnHomepage()&&b("CSS").removeClass(d,"sidebarMode");var e=b("Event").listen(window,"resize",b("throttle")(function(){j&&(c.shouldLoadContent(a)&&(j=!1,e.remove(),c.loadContentForConfig(a)))},50));this.loadOnTransition(a);b("Run").onCleanupOrLeave(a.container,function(){j&&(j=!1,e.remove())})}},loadOnTransition:function(a){var c=this;if(g||h)var d=b("Arbiter").subscribe("page_transition",function(e,f){e=document.documentElement||"";!c.isOnHomepage(f.uri.getPath())?h&&b("CSS").addClass(e,i):(h&&(b("CSS").removeClass(e,i),b("Bootloader").loadModules(["Dock"],function(a){a.resizeAllFlyouts()},"ResponsiveSidebar")),b("ChatSidebarVisibility").shouldShowSidebar(null,function(b,e){j&&setTimeout(function(){c.loadContentForConfig(a)}),j=!1,d.unsubscribe()},f.uri))})},isOnHomepage:function(a){return(a||new(b("URI"))(window.location.href).getPath())==="/"},shouldLoadContent:function(a){var b=(g||h)&&!this.isOnHomepage();return!b&&a.triggerWidth<window.innerWidth},loadContentForConfig:function(a){var c="/ajax/pagelet/generic.php/SidebarPagelet";new(b("AjaxPipeRequest"))(b("getOrCreateDOMID")(a.container),c).send()}};e.exports=a}),null);